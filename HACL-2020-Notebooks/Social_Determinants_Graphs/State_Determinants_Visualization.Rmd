---
title: "State Determinants Visualization"
output: html_document
---

This notebook can be used to reproduce the visualizations for the social determinants of each state. States that did not have enough data were AK,CT, DE, HI, ME, MD, MA, NV, NH, NJ, NM, RI, UT, VT, and WY.

from ProtoNotebook
```{r echo = F}

#### Library and Data Imports ####
## Load essential R packages
source("Modules/Source.R")
## Load in model outputs per state:
source("Modules/load_model_output.R")

```

from ProtoNotebook
```{r echo = F}

  # use GWAS_ADJ_P and GWAS_MRR to say for which states there are significant protective and destructive variables

  s = ""
  for (state in colnames(GWAS_MRR)) {
    s <- paste(s, state, ": ", sep = "")
    
    prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          #des <- c(des, GWAS_MRR[[state]][itr])
          des <- c(des, itr)
        } else {
          #prt <- c(prt, GWAS_MRR[[state]][itr])
          prt <- c(prt, itr)
        }
      }
    }
  
    if (length(prt) > 1) {
      s <- paste(s, "protective variables include: ", sep = "")
      for ( i  in 2:length(prt) ) {
        if (i != length(prt)) {
          s <- paste(s, colnames(model_input)[prt[i]], ", ", sep = "")
        } else {
          s <- paste(s, colnames(model_input)[prt[i]], " ", sep = "")
        }
      }
    } else {
      s <- paste(s, "no protective variables; ", sep = "")
    }
    
    if (length(des) > 1) {
      s <- paste(s, "destructive variables include: ", sep = "")
      for ( i  in 2:length(des) ) {
        if (i != length(des)) {
          s <- paste(s, colnames(model_input)[des[i]], ", ", sep = "")
        } else {
          s <- paste(s, colnames(model_input)[des[i]], "", sep = "")
        }
      }
    } else {
      s <- paste(s, "no destructive variables;", sep = "")
    }
    
    s <- paste(s, "\n", sep ="")
  }

  cat(s)


```

Start of State Visualization

Alabama
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
#select state  
  state = "AL"
  state
#sorts determinants as protective or destructive
   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

#create data frame    
    dataAL <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataAL <- dataAL %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataAL$y <- factor(dataAL$y, levels = dataAL$y)

#round MRR to 2 decimal places
x <- dataAL$x
x_num<-round(x,digits=2)
dataAL$x_round = x_num

dataAL$y <- as.character(dataAL$y)
dataAL$y[dataAL$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataAL$y[dataAL$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataAL$y[dataAL$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataAL$y[dataAL$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataAL$y[dataAL$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataAL$y[dataAL$y == "Active"] <- "Number of Active COVID-19 Cases"
dataAL$y[dataAL$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"

dataAL$y <- factor(dataAL$y, levels = dataAL$y[order(dataAL$x)])

#plot
p<- ggplot(dataAL, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=7, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_round), vjust=0.5,color="#ebebeb", size=3.5, nudge_x=.1)+
  geom_text(aes(label=x_round, colour=x_round<1), vjust=0.5,  colour= "#ebebeb" , size=3.5, nudge_x = -.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("AL_desprt.png")
```

Alaska (not enough)
```{r echo = F}
  library(ggplot2)
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))

ggsave("AK_desprt.png")
```

Arizona 
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "AZ"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataAZ <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataAZ <- dataAZ %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataAZ$y <- factor(dataAZ$y, levels = dataAZ$y)

#plot
x <- dataAZ$x
x_num<-round(x,digits=2)
dataAZ$x_round = x_num
dataAZ <- subset(dataAZ,  x_round > 0.05)

# naming features
dataAZ$y <- as.character(dataAZ$y)
dataAZ$y[dataAZ$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataAZ$y[dataAZ$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataAZ$y[dataAZ$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataAZ$y[dataAZ$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataAZ$y[dataAZ$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataAZ$y[dataAZ$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataAZ$y[dataAZ$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataAZ$y[dataAZ$y == "% Uninsured"] <- "% of County Uninsured"
dataAZ$y[dataAZ$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataAZ$y[dataAZ$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataAZ$y[dataAZ$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataAZ$y[dataAZ$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataAZ$y[dataAZ$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataAZ$y[dataAZ$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataAZ$y[dataAZ$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataAZ$y[dataAZ$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataAZ$y[dataAZ$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataAZ$y[dataAZ$y == "Active"] <- "Number of Active COVID-19 Cases"
dataAZ$y[dataAZ$y == "Lat"] <- "Latitude"
dataAZ$y[dataAZ$y == "Long_"] <- "Longitude"
dataAZ$y[dataAZ$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataAZ$y[dataAZ$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataAZ$y[dataAZ$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataAZ$y[dataAZ$y == "poverty"] <- "% Living in Poverty"
dataAZ$y[dataAZ$y == "popdensity"] <- "Population Density"
dataAZ$y[dataAZ$y == "medianhousevalue"] <- "Median House Value"
dataAZ$y[dataAZ$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataAZ$y[dataAZ$y == "education"] <- "% with less than High-School Education"
dataAZ$y[dataAZ$y == "population"] <- "Overall Population"
dataAZ$y[dataAZ$y == "pct_blk"] <- "% African American in County"
dataAZ$y[dataAZ$y == "hispanic"] <- "% Hispanic in County"
dataAZ$y[dataAZ$y == "pct_asian"] <- "% Asian in County"
dataAZ$y[dataAZ$y == "pct_native"] <- "% Native American in County"
dataAZ$y[dataAZ$y == "pct_white"] <- "% White in County"
dataAZ$y[dataAZ$y == "q_popdensity"] <- "Population Density"
dataAZ$y[dataAZ$y == "older_pecent"] <- "% of Population Age 65+"
dataAZ$y[dataAZ$y == "young_pecent"] <- "% of Population Ages 0-14"
dataAZ$y[dataAZ$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataAZ$y[dataAZ$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataAZ$y[dataAZ$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataAZ$y[dataAZ$y == "pct_obesity"] <- "% of Adults with Obesity"
dataAZ$y[dataAZ$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataAZ$y[dataAZ$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataAZ$y[dataAZ$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataAZ$y[dataAZ$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataAZ$y[dataAZ$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataAZ$y[dataAZ$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataAZ$y[dataAZ$y == "infant_deaths"] <- "Number of Infant Deaths"
dataAZ$y[dataAZ$y == "pct_diabetes"] <- "% of County with Diabetes"
dataAZ$y[dataAZ$y == "# Food Insecure"] <- "# Food Insecurity"
dataAZ$y[dataAZ$y == "% Food Insecure"] <- "% Food Insecurity"
dataAZ$y[dataAZ$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataAZ$y[dataAZ$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataAZ$y[dataAZ$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
# remove number uninsured
#dataAZ$y[dataAZ$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataAZ$y[dataAZ$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataAZ$y[dataAZ$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataAZ$y[dataAZ$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataAZ$y[dataAZ$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataAZ$y[dataAZ$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataAZ$y[dataAZ$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataAZ$y[dataAZ$y == "Denominator"] <- "Estimated Number of Juveniles"
dataAZ$y[dataAZ$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataAZ$y[dataAZ$y == "pct_age65"] <- "% of Adults Age 65+"
dataAZ$y[dataAZ$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataAZ$y[dataAZ$y == "Assault.death_rate"] <- "Assault Death Rate"
dataAZ$y[dataAZ$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataAZ$y[dataAZ$y == "Despair.death_rate"] <- "Despair Death Rate"
dataAZ$y[dataAZ$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataAZ$y[dataAZ$y == "COPD"] <- "% of County with COPD"
dataAZ$y[dataAZ$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataAZ$y[dataAZ$y == "LungCancer"] <- "% of County with Lung Cancer"
dataAZ$y[dataAZ$y == "# Associations"] <- "# of Social Associations"

# remove unneeded columns
#tempb4 <- nrow(dataAZ)
#tempb4

#removeAZ <- c("# Associations")
#dataAZ[ !(row.names(dataAZ) %in% removeAZ), ]

#tempAFTR <- nrow(dataAZ)
#tempAFTR

dataAZ$y <- factor(dataAZ$y, levels = dataAZ$y[order(dataAZ$x)])

p<-ggplot(dataAZ, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=1, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_round), vjust=0.5,color="black", size=3.5,nudge_x=.1)+
 # geom_text(aes(label=x_round, colour=x_round<1), vjust=0.5,  colour= "#ebebeb" , size=3.5, nudge_x = -.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)

dataAZ_destructive_high <-subset(dataAZ, x_round >20)

p_1<-ggplot(dataAZ_destructive_high, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=7, alpha=0.9 ) +
  scale_color_manual(values = c("#bd0026", "#253494")) +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_round, colour=x_round<1), vjust=0.5,  colour= "#ebebeb" , size=3.3, nudge_x = -8.5)+
  geom_segment( aes(x=1, xend=1, y=0, yend = 7.5), size = 1.0)+ 
  theme(axis.text = element_text(size = 10)) 

dataAZ_destructive_high_1<-subset(dataAZ, x_round <20)
dataAZ_destructive_high_1<-subset(dataAZ_destructive_high_1, x_round >15)

p_2<-ggplot(dataAZ_destructive_high_1, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=6, alpha=0.9 ) +
  scale_color_manual(values = c("#bd0026", "#253494")) +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_round, colour=x_round<1), vjust=0.5,  colour= "#ebebeb" , size=3.3, nudge_x = -1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = 15), size = 1.0)+ 
  theme(axis.text = element_text(size = 10)) 

dataAZ_destructive_high_2<-subset(dataAZ, x_round <15)
dataAZ_destructive_high_2<-subset(dataAZ_destructive_high_2, x_round >10)

p_3<-ggplot(dataAZ_destructive_high_2, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=5, alpha=0.9 ) +
  scale_color_manual(values = c("#bd0026", "#253494")) +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_round, colour=x_round<1), vjust=0.5,  colour= "#ebebeb" , size=3.3, nudge_x = -1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = 23), size = 1.0)+ 
  theme(axis.text = element_text(size = 10)) 

dataAZ_destructive_high_3<-subset(dataAZ, x_round <10)
dataAZ_destructive_high_3<-subset(dataAZ_destructive_high_3, x_round >1)

p_4<-ggplot(dataAZ_destructive_high_3, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=4.5, alpha=0.9 ) +
  scale_color_manual(values = c("#bd0026", "#253494")) +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_round, colour=x_round<1), vjust=0.5,  colour= "black" , size=3, nudge_x = .5)+
  geom_segment( aes(x=1, xend=1, y=0, yend = 26), size = 1.0)+ 
  theme(axis.text = element_text(size = 10)) 

dataAZ_protective<-subset(dataAZ, x_round <1)
dataAZ_protective<-subset(dataAZ_protective, x_round >.5)

p_5<-ggplot(dataAZ_protective, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=5.5, alpha=0.9 ) +
  scale_color_manual(values = c("#253494","#bd0026")) +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_round, colour=x_round>1), vjust=0.5,  colour= "black" , size=3, nudge_x = -.025)+
  geom_segment( aes(x=1, xend=1, y=0, yend = 15), size = 1.0)+ 
  theme(axis.text = element_text(size = 10)) 
}
p
p_1
p_2
p_3
p_4
p_5

ggsave("AZ_desprt_1.png",p_1)
ggsave("AZ_desprt_2.png",p_2)
ggsave("AZ_desprt_3.png",p_3)
ggsave("AZ_desprt_4.png",p_4)
ggsave("AZ_desprt_5.png",p_5)
```

Arkansas
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "AR"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataAR <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataAR <- dataAR %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataAR$y <- factor(dataAR$y, levels = dataAR$y)

#plot
x <- dataAR$x
x_num<-round(x,digits=2)
dataAR$x_round = x_num

dataAR$y <- as.character(dataAR$y)
dataAR$y[dataAR$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataAR$y[dataAR$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataAR$y[dataAR$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataAR$y[dataAR$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataAR$y[dataAR$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataAR$y[dataAR$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataAR$y[dataAR$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataAR$y[dataAR$y == "% Uninsured"] <- "% of County Uninsured"
dataAR$y[dataAR$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataAR$y[dataAR$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataAR$y[dataAR$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataAR$y[dataAR$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataAR$y[dataAR$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataAR$y[dataAR$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataAR$y[dataAR$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataAR$y[dataAR$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataAR$y[dataAR$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataAR$y[dataAR$y == "Active"] <- "Number of Active COVID-19 Cases"
dataAR$y[dataAR$y == "Lat"] <- "Latitude"
dataAR$y[dataAR$y == "Long_"] <- "Longitude"
dataAR$y[dataAR$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataAR$y[dataAR$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataAR$y[dataAR$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataAR$y[dataAR$y == "poverty"] <- "% Living in Poverty"
dataAR$y[dataAR$y == "popdensity"] <- "Population Density"
dataAR$y[dataAR$y == "medianhousevalue"] <- "Median House Value"
dataAR$y[dataAR$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataAR$y[dataAR$y == "education"] <- "% with less than High-School Education"
dataAR$y[dataAR$y == "population"] <- "Overall Population"
dataAR$y[dataAR$y == "pct_blk"] <- "% African American in County"
dataAR$y[dataAR$y == "hispanic"] <- "% Hispanic in County"
dataAR$y[dataAR$y == "pct_asian"] <- "% Asian in County"
dataAR$y[dataAR$y == "pct_native"] <- "% Native American in County"
dataAR$y[dataAR$y == "pct_white"] <- "% White in County"
dataAR$y[dataAR$y == "q_popdensity"] <- "Population Density"
dataAR$y[dataAR$y == "older_pecent"] <- "% of Population Age 65+"
dataAR$y[dataAR$y == "young_pecent"] <- "% of Population Ages 0-14"
dataAR$y[dataAR$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataAR$y[dataAR$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataAR$y[dataAR$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataAR$y[dataAR$y == "pct_obesity"] <- "% of Adults with Obesity"
dataAR$y[dataAR$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataAR$y[dataAR$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataAR$y[dataAR$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataAR$y[dataAR$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataAR$y[dataAR$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataAR$y[dataAR$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataAR$y[dataAR$y == "infant_deaths"] <- "Number of Infant Deaths"
dataAR$y[dataAR$y == "pct_diabetes"] <- "% of County with Diabetes"
dataAR$y[dataAR$y == "# Food Insecure"] <- "# Food Insecurity"
dataAR$y[dataAR$y == "% Food Insecure"] <- "% Food Insecurity"
dataAR$y[dataAR$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataAR$y[dataAR$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataAR$y[dataAR$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataAR$y[dataAR$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataAR$y[dataAR$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataAR$y[dataAR$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataAR$y[dataAR$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataAR$y[dataAR$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataAR$y[dataAR$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataAR$y[dataAR$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataAR$y[dataAR$y == "Denominator"] <- "Estimated Number of Juveniles"
dataAR$y[dataAR$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataAR$y[dataAR$y == "pct_age65"] <- "% of Adults Age 65+"
dataAR$y[dataAR$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataAR$y[dataAR$y == "Assault.death_rate"] <- "Assault Death Rate"
dataAR$y[dataAR$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataAR$y[dataAR$y == "Despair.death_rate"] <- "Despair Death Rate"
dataAR$y[dataAR$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataAR$y[dataAR$y == "COPD"] <- "% of County with COPD"
dataAR$y[dataAR$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataAR$y[dataAR$y == "LungCancer"] <- "% of County with Lung Cancer"

dataAR$y <- factor(dataAR$y, levels = dataAR$y[order(dataAR$x)])

p<-ggplot(dataAR, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x=.1)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x=-.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("AR_desprt.png")
```

California
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "CA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataCA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataCA <- dataCA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataCA$y <- factor(dataCA$y, levels = dataCA$y)

#plot
x <- dataCA$x
x_num<-round(x,digits=2)
dataCA$x_round = x_num

dataCA$y <- as.character(dataCA$y)
dataCA$y[dataCA$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataCA$y[dataCA$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataCA$y[dataCA$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataCA$y[dataCA$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataCA$y[dataCA$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataCA$y[dataCA$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataCA$y[dataCA$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataCA$y[dataCA$y == "% Uninsured"] <- "% of County Uninsured"
dataCA$y[dataCA$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataCA$y[dataCA$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataCA$y[dataCA$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataCA$y[dataCA$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataCA$y[dataCA$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataCA$y[dataCA$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataCA$y[dataCA$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataCA$y[dataCA$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataCA$y[dataCA$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataCA$y[dataCA$y == "Active"] <- "Number of Active COVID-19 Cases"
dataCA$y[dataCA$y == "Lat"] <- "Latitude"
dataCA$y[dataCA$y == "Long_"] <- "Longitude"
dataCA$y[dataCA$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataCA$y[dataCA$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataCA$y[dataCA$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataCA$y[dataCA$y == "poverty"] <- "% Living in Poverty"
dataCA$y[dataCA$y == "popdensity"] <- "Population Density"
dataCA$y[dataCA$y == "medianhousevalue"] <- "Median House Value"
dataCA$y[dataCA$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataCA$y[dataCA$y == "education"] <- "% with less than High-School Education"
dataCA$y[dataCA$y == "population"] <- "Overall Population"
dataCA$y[dataCA$y == "pct_blk"] <- "% African American in County"
dataCA$y[dataCA$y == "hispanic"] <- "% Hispanic in County"
dataCA$y[dataCA$y == "pct_asian"] <- "% Asian in County"
dataCA$y[dataCA$y == "pct_native"] <- "% Native American in County"
dataCA$y[dataCA$y == "pct_white"] <- "% White in County"
dataCA$y[dataCA$y == "q_popdensity"] <- "Population Density"
dataCA$y[dataCA$y == "older_pecent"] <- "% of Population Age 65+"
dataCA$y[dataCA$y == "young_pecent"] <- "% of Population Ages 0-14"
dataCA$y[dataCA$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataCA$y[dataCA$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataCA$y[dataCA$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataCA$y[dataCA$y == "pct_obesity"] <- "% of Adults with Obesity"
dataCA$y[dataCA$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataCA$y[dataCA$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataCA$y[dataCA$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataCA$y[dataCA$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataCA$y[dataCA$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataCA$y[dataCA$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataCA$y[dataCA$y == "infant_deaths"] <- "Number of Infant Deaths"
dataCA$y[dataCA$y == "pct_diabetes"] <- "% of County with Diabetes"
dataCA$y[dataCA$y == "# Food Insecure"] <- "# Food Insecurity"
dataCA$y[dataCA$y == "% Food Insecure"] <- "% Food Insecurity"
dataCA$y[dataCA$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataCA$y[dataCA$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataCA$y[dataCA$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataCA$y[dataCA$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataCA$y[dataCA$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataCA$y[dataCA$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataCA$y[dataCA$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataCA$y[dataCA$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataCA$y[dataCA$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataCA$y[dataCA$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataCA$y[dataCA$y == "Denominator"] <- "Estimated Number of Juveniles"
dataCA$y[dataCA$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataCA$y[dataCA$y == "pct_age65"] <- "% of Adults Age 65+"
dataCA$y[dataCA$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataCA$y[dataCA$y == "Assault.death_rate"] <- "Assault Death Rate"
dataCA$y[dataCA$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataCA$y[dataCA$y == "Despair.death_rate"] <- "Despair Death Rate"
dataCA$y[dataCA$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataCA$y[dataCA$y == "COPD"] <- "% of County with COPD"
dataCA$y[dataCA$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataCA$y[dataCA$y == "LungCancer"] <- "% of County with Lung Cancer"

dataCA$y <- factor(dataCA$y, levels = dataCA$y[order(dataCA$x)])

p<-ggplot(dataCA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_round, colour=x_round<1), vjust=0.5,  colour= "#ebebeb" , size=3.5, nudge_x = .06)+
  geom_text(aes(label=x_round, colour=x_round<1), vjust=0.5,  colour= "#ebebeb" , size=3.5, nudge_x = -.06)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)))
}
p
ggsave("CA_desprt.png")
```

Colorado
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "CO"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataCO <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataCO <- dataCO %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataCO$y <- factor(dataCO$y, levels = dataCO$y)

#plot
x <- dataCO$x
x_num<-round(x,digits=2)
dataCO$x_round = x_num

dataCO$y <- as.character(dataCO$y)
dataCO$y[dataCO$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataCO$y[dataCO$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataCO$y[dataCO$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataCO$y[dataCO$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataCO$y[dataCO$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataCO$y[dataCO$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataCO$y[dataCO$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataCO$y[dataCO$y == "% Uninsured"] <- "% of County Uninsured"
dataCO$y[dataCO$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataCO$y[dataCO$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataCO$y[dataCO$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataCO$y[dataCO$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataCO$y[dataCO$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataCO$y[dataCO$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataCO$y[dataCO$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataCO$y[dataCO$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataCO$y[dataCO$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataCO$y[dataCO$y == "Active"] <- "Number of Active COVID-19 Cases"
dataCO$y[dataCO$y == "Lat"] <- "Latitude"
dataCO$y[dataCO$y == "Long_"] <- "Longitude"
dataCO$y[dataCO$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataCO$y[dataCO$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataCO$y[dataCO$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataCO$y[dataCO$y == "poverty"] <- "% Living in Poverty"
dataCO$y[dataCO$y == "popdensity"] <- "Population Density"
dataCO$y[dataCO$y == "medianhousevalue"] <- "Median House Value"
dataCO$y[dataCO$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataCO$y[dataCO$y == "education"] <- "% with less than High-School Education"
dataCO$y[dataCO$y == "population"] <- "Overall Population"
dataCO$y[dataCO$y == "pct_blk"] <- "% African American in County"
dataCO$y[dataCO$y == "hispanic"] <- "% Hispanic in County"
dataCO$y[dataCO$y == "pct_asian"] <- "% Asian in County"
dataCO$y[dataCO$y == "pct_native"] <- "% Native American in County"
dataCO$y[dataCO$y == "pct_white"] <- "% White in County"
dataCO$y[dataCO$y == "q_popdensity"] <- "Population Density"
dataCO$y[dataCO$y == "older_pecent"] <- "% of Population Age 65+"
dataCO$y[dataCO$y == "young_pecent"] <- "% of Population Ages 0-14"
dataCO$y[dataCO$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataCO$y[dataCO$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataCO$y[dataCO$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataCO$y[dataCO$y == "pct_obesity"] <- "% of Adults with Obesity"
dataCO$y[dataCO$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataCO$y[dataCO$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataCO$y[dataCO$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataCO$y[dataCO$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataCO$y[dataCO$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataCO$y[dataCO$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataCO$y[dataCO$y == "infant_deaths"] <- "Number of Infant Deaths"
dataCO$y[dataCO$y == "pct_diabetes"] <- "% of County with Diabetes"
dataCO$y[dataCO$y == "# Food Insecure"] <- "# Food Insecurity"
dataCO$y[dataCO$y == "% Food Insecure"] <- "% Food Insecurity"
dataCO$y[dataCO$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataCO$y[dataCO$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataCO$y[dataCO$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataCO$y[dataCO$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataCO$y[dataCO$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataCO$y[dataCO$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataCO$y[dataCO$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataCO$y[dataCO$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataCO$y[dataCO$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataCO$y[dataCO$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataCO$y[dataCO$y == "Denominator"] <- "Estimated Number of Juveniles"
dataCO$y[dataCO$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataCO$y[dataCO$y == "pct_age65"] <- "% of Adults Age 65+"
dataCO$y[dataCO$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataCO$y[dataCO$y == "Assault.death_rate"] <- "Assault Death Rate"
dataCO$y[dataCO$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataCO$y[dataCO$y == "Despair.death_rate"] <- "Despair Death Rate"
dataCO$y[dataCO$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataCO$y[dataCO$y == "COPD"] <- "% of County with COPD"
dataCO$y[dataCO$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataCO$y[dataCO$y == "LungCancer"] <- "% of County with Lung Cancer"

dataCO$y <- factor(dataCO$y, levels = dataCO$y[order(dataCO$x)])

p<-ggplot(dataCO, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .2)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.2) +
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("CO_desprt.png")
```

Connecticut (Insufficient data or no protective or destructive variables in this state)
```{r}
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))

ggsave("CT_desprt.png")
```

Delaware (Insufficient data or no protective or destructive variables in this state)
```{r}
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))

ggsave("DE_desprt.png")
```


Florida
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "FL"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataFL <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataFL <- dataFL %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataFL$y <- factor(dataFL$y, levels = dataFL$y)

#plot
x <- dataFL$x
x_num<-round(x,digits=2)
dataFL$x_round = x_num

dataFL$y <- as.character(dataFL$y)
dataFL$y[dataFL$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataFL$y[dataFL$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataFL$y[dataFL$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataFL$y[dataFL$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataFL$y[dataFL$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataFL$y[dataFL$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataFL$y[dataFL$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataFL$y[dataFL$y == "% Uninsured"] <- "% of County Uninsured"
dataFL$y[dataFL$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataFL$y[dataFL$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataFL$y[dataFL$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataFL$y[dataFL$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataFL$y[dataFL$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataFL$y[dataFL$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataFL$y[dataFL$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataFL$y[dataFL$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataFL$y[dataFL$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataFL$y[dataFL$y == "Active"] <- "Number of Active COVID-19 Cases"
dataFL$y[dataFL$y == "Lat"] <- "Latitude"
dataFL$y[dataFL$y == "Long_"] <- "Longitude"
dataFL$y[dataFL$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataFL$y[dataFL$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataFL$y[dataFL$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataFL$y[dataFL$y == "poverty"] <- "% Living in Poverty"
dataFL$y[dataFL$y == "popdensity"] <- "Population Density"
dataFL$y[dataFL$y == "medianhousevalue"] <- "Median House Value"
dataFL$y[dataFL$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataFL$y[dataFL$y == "education"] <- "% with less than High-School Education"
dataFL$y[dataFL$y == "population"] <- "Overall Population"
dataFL$y[dataFL$y == "pct_blk"] <- "% African American in County"
dataFL$y[dataFL$y == "hispanic"] <- "% Hispanic in County"
dataFL$y[dataFL$y == "pct_asian"] <- "% Asian in County"
dataFL$y[dataFL$y == "pct_native"] <- "% Native American in County"
dataFL$y[dataFL$y == "pct_white"] <- "% White in County"
dataFL$y[dataFL$y == "q_popdensity"] <- "Population Density"
dataFL$y[dataFL$y == "older_pecent"] <- "% of Population Age 65+"
dataFL$y[dataFL$y == "young_pecent"] <- "% of Population Ages 0-14"
dataFL$y[dataFL$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataFL$y[dataFL$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataFL$y[dataFL$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataFL$y[dataFL$y == "pct_obesity"] <- "% of Adults with Obesity"
dataFL$y[dataFL$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataFL$y[dataFL$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataFL$y[dataFL$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataFL$y[dataFL$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataFL$y[dataFL$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataFL$y[dataFL$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataFL$y[dataFL$y == "infant_deaths"] <- "Number of Infant Deaths"
dataFL$y[dataFL$y == "pct_diabetes"] <- "% of County with Diabetes"
dataFL$y[dataFL$y == "# Food Insecure"] <- "# Food Insecurity"
dataFL$y[dataFL$y == "% Food Insecure"] <- "% Food Insecurity"
dataFL$y[dataFL$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataFL$y[dataFL$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataFL$y[dataFL$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataFL$y[dataFL$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataFL$y[dataFL$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataFL$y[dataFL$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataFL$y[dataFL$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataFL$y[dataFL$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataFL$y[dataFL$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataFL$y[dataFL$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataFL$y[dataFL$y == "Denominator"] <- "Estimated Number of Juveniles"
dataFL$y[dataFL$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataFL$y[dataFL$y == "pct_age65"] <- "% of Adults Age 65+"
dataFL$y[dataFL$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataFL$y[dataFL$y == "Assault.death_rate"] <- "Assault Death Rate"
dataFL$y[dataFL$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataFL$y[dataFL$y == "Despair.death_rate"] <- "Despair Death Rate"
dataFL$y[dataFL$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataFL$y[dataFL$y == "COPD"] <- "% of County with COPD"
dataFL$y[dataFL$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataFL$y[dataFL$y == "LungCancer"] <- "% of County with Lung Cancer"

dataFL$y <- factor(dataFL$y, levels = dataFL$y[order(dataFL$x)])

p<-ggplot(dataFL, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=3, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5, nudge_x = .075)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)+
  theme(axis.text = element_text(size = 8))
}
p
ggsave("FL_desprt.png")
```

Georgia
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "GA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataGA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataGA <- dataGA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataGA$y <- factor(dataGA$y, levels = dataGA$y)

#plot
x <- dataGA$x
x_num<-round(x,digits=2)
dataGA$x_round = x_num

dataGA$y <- as.character(dataGA$y)
dataGA$y[dataGA$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataGA$y[dataGA$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataGA$y[dataGA$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataGA$y[dataGA$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataGA$y[dataGA$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataGA$y[dataGA$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataGA$y[dataGA$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataGA$y[dataGA$y == "% Uninsured"] <- "% of County Uninsured"
dataGA$y[dataGA$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataGA$y[dataGA$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataGA$y[dataGA$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataGA$y[dataGA$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataGA$y[dataGA$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataGA$y[dataGA$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataGA$y[dataGA$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataGA$y[dataGA$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataGA$y[dataGA$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataGA$y[dataGA$y == "Active"] <- "Number of Active COVID-19 Cases"
dataGA$y[dataGA$y == "Lat"] <- "Latitude"
dataGA$y[dataGA$y == "Long_"] <- "Longitude"
dataGA$y[dataGA$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataGA$y[dataGA$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataGA$y[dataGA$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataGA$y[dataGA$y == "poverty"] <- "% Living in Poverty"
dataGA$y[dataGA$y == "popdensity"] <- "Population Density"
dataGA$y[dataGA$y == "medianhousevalue"] <- "Median House Value"
dataGA$y[dataGA$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataGA$y[dataGA$y == "education"] <- "% with less than High-School Education"
dataGA$y[dataGA$y == "population"] <- "Overall Population"
dataGA$y[dataGA$y == "pct_blk"] <- "% African American in County"
dataGA$y[dataGA$y == "hispanic"] <- "% Hispanic in County"
dataGA$y[dataGA$y == "pct_asian"] <- "% Asian in County"
dataGA$y[dataGA$y == "pct_native"] <- "% Native American in County"
dataGA$y[dataGA$y == "pct_white"] <- "% White in County"
dataGA$y[dataGA$y == "q_popdensity"] <- "Population Density"
dataGA$y[dataGA$y == "older_pecent"] <- "% of Population Age 65+"
dataGA$y[dataGA$y == "young_pecent"] <- "% of Population Ages 0-14"
dataGA$y[dataGA$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataGA$y[dataGA$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataGA$y[dataGA$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataGA$y[dataGA$y == "pct_obesity"] <- "% of Adults with Obesity"
dataGA$y[dataGA$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataGA$y[dataGA$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataGA$y[dataGA$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataGA$y[dataGA$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataGA$y[dataGA$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataGA$y[dataGA$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataGA$y[dataGA$y == "infant_deaths"] <- "Number of Infant Deaths"
dataGA$y[dataGA$y == "pct_diabetes"] <- "% of County with Diabetes"
dataGA$y[dataGA$y == "# Food Insecure"] <- "# Food Insecurity"
dataGA$y[dataGA$y == "% Food Insecure"] <- "% Food Insecurity"
dataGA$y[dataGA$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataGA$y[dataGA$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataGA$y[dataGA$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataGA$y[dataGA$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataGA$y[dataGA$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataGA$y[dataGA$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataGA$y[dataGA$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataGA$y[dataGA$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataGA$y[dataGA$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataGA$y[dataGA$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataGA$y[dataGA$y == "Denominator"] <- "Estimated Number of Juveniles"
dataGA$y[dataGA$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataGA$y[dataGA$y == "pct_age65"] <- "% of Adults Age 65+"
dataGA$y[dataGA$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataGA$y[dataGA$y == "Assault.death_rate"] <- "Assault Death Rate"
dataGA$y[dataGA$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataGA$y[dataGA$y == "Despair.death_rate"] <- "Despair Death Rate"
dataGA$y[dataGA$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataGA$y[dataGA$y == "COPD"] <- "% of County with COPD"
dataGA$y[dataGA$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataGA$y[dataGA$y == "LungCancer"] <- "% of County with Lung Cancer"

dataGA$y <- factor(dataGA$y, levels = dataGA$y[order(dataGA$x)])

p<-ggplot(dataGA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=9, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .1)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("GA_desprt.png")
```

Hawaii (Insufficient data or no protective or destructive variables in this state)

```{r}
 library(ggplot2)
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))

ggsave("HI_desprt.png")
```



Idaho  
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "ID"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataID <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataID <- dataID %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataID$y <- factor(dataID$y, levels = dataID$y)

#plot
x <- dataID$x
x_num<-round(x,digits=2)
dataID$x_round = x_num

dataID$y <- as.character(dataID$y)
dataID$y[dataID$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataID$y[dataID$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataID$y[dataID$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataID$y[dataID$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataID$y[dataID$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataID$y[dataID$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataID$y[dataID$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataID$y[dataID$y == "% Uninsured"] <- "% of County Uninsured"
dataID$y[dataID$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataID$y[dataID$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataID$y[dataID$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataID$y[dataID$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataID$y[dataID$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataID$y[dataID$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataID$y[dataID$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataID$y[dataID$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataID$y[dataID$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataID$y[dataID$y == "Active"] <- "Number of Active COVID-19 Cases"
dataID$y[dataID$y == "Lat"] <- "Latitude"
dataID$y[dataID$y == "Long_"] <- "Longitude"
dataID$y[dataID$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataID$y[dataID$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataID$y[dataID$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataID$y[dataID$y == "poverty"] <- "% Living in Poverty"
dataID$y[dataID$y == "popdensity"] <- "Population Density"
dataID$y[dataID$y == "medianhousevalue"] <- "Median House Value"
dataID$y[dataID$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataID$y[dataID$y == "education"] <- "% with less than High-School Education"
dataID$y[dataID$y == "population"] <- "Overall Population"
dataID$y[dataID$y == "pct_blk"] <- "% African American in County"
dataID$y[dataID$y == "hispanic"] <- "% Hispanic in County"
dataID$y[dataID$y == "pct_asian"] <- "% Asian in County"
dataID$y[dataID$y == "pct_native"] <- "% Native American in County"
dataID$y[dataID$y == "pct_white"] <- "% White in County"
dataID$y[dataID$y == "q_popdensity"] <- "Population Density"
dataID$y[dataID$y == "older_pecent"] <- "% of Population Age 65+"
dataID$y[dataID$y == "young_pecent"] <- "% of Population Ages 0-14"
dataID$y[dataID$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataID$y[dataID$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataID$y[dataID$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataID$y[dataID$y == "pct_obesity"] <- "% of Adults with Obesity"
dataID$y[dataID$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataID$y[dataID$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataID$y[dataID$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataID$y[dataID$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataID$y[dataID$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataID$y[dataID$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataID$y[dataID$y == "infant_deaths"] <- "Number of Infant Deaths"
dataID$y[dataID$y == "pct_diabetes"] <- "% of County with Diabetes"
dataID$y[dataID$y == "# Food Insecure"] <- "# Food Insecurity"
dataID$y[dataID$y == "% Food Insecure"] <- "% Food Insecurity"
dataID$y[dataID$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataID$y[dataID$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataID$y[dataID$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataID$y[dataID$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataID$y[dataID$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataID$y[dataID$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataID$y[dataID$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataID$y[dataID$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataID$y[dataID$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataID$y[dataID$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataID$y[dataID$y == "Denominator"] <- "Estimated Number of Juveniles"
dataID$y[dataID$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataID$y[dataID$y == "pct_age65"] <- "% of Adults Age 65+"
dataID$y[dataID$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataID$y[dataID$y == "Assault.death_rate"] <- "Assault Death Rate"
dataID$y[dataID$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataID$y[dataID$y == "Despair.death_rate"] <- "Despair Death Rate"
dataID$y[dataID$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataID$y[dataID$y == "COPD"] <- "% of County with COPD"
dataID$y[dataID$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataID$y[dataID$y == "LungCancer"] <- "% of County with Lung Cancer"

dataID$y <- factor(dataID$y, levels = dataID$y[order(dataID$x)])

ggplot(dataID, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .5)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.5)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}

ggsave("ID_desprt.png")
```

Illinois
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "IL"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataIL <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataIL <- dataIL %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataIL$y <- factor(dataIL$y, levels = dataIL$y)

#plot
x <- dataIL$x
x_num<-round(x,digits=2)
dataIL$x_round = x_num

dataIL$y <- as.character(dataIL$y)
dataIL$y[dataIL$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataIL$y[dataIL$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataIL$y[dataIL$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataIL$y[dataIL$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataIL$y[dataIL$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataIL$y[dataIL$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataIL$y[dataIL$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataIL$y[dataIL$y == "% Uninsured"] <- "% of County Uninsured"
dataIL$y[dataIL$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataIL$y[dataIL$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataIL$y[dataIL$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataIL$y[dataIL$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataIL$y[dataIL$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataIL$y[dataIL$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataIL$y[dataIL$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataIL$y[dataIL$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataIL$y[dataIL$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataIL$y[dataIL$y == "Active"] <- "Number of Active COVID-19 Cases"
dataIL$y[dataIL$y == "Lat"] <- "Latitude"
dataIL$y[dataIL$y == "Long_"] <- "Longitude"
dataIL$y[dataIL$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataIL$y[dataIL$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataIL$y[dataIL$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataIL$y[dataIL$y == "poverty"] <- "% Living in Poverty"
dataIL$y[dataIL$y == "popdensity"] <- "Population Density"
dataIL$y[dataIL$y == "medianhousevalue"] <- "Median House Value"
dataIL$y[dataIL$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataIL$y[dataIL$y == "education"] <- "% with less than High-School Education"
dataIL$y[dataIL$y == "population"] <- "Overall Population"
dataIL$y[dataIL$y == "pct_blk"] <- "% African American in County"
dataIL$y[dataIL$y == "hispanic"] <- "% Hispanic in County"
dataIL$y[dataIL$y == "pct_asian"] <- "% Asian in County"
dataIL$y[dataIL$y == "pct_native"] <- "% Native American in County"
dataIL$y[dataIL$y == "pct_white"] <- "% White in County"
dataIL$y[dataIL$y == "q_popdensity"] <- "Population Density"
dataIL$y[dataIL$y == "older_pecent"] <- "% of Population Age 65+"
dataIL$y[dataIL$y == "young_pecent"] <- "% of Population Ages 0-14"
dataIL$y[dataIL$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataIL$y[dataIL$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataIL$y[dataIL$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataIL$y[dataIL$y == "pct_obesity"] <- "% of Adults with Obesity"
dataIL$y[dataIL$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataIL$y[dataIL$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataIL$y[dataIL$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataIL$y[dataIL$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataIL$y[dataIL$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataIL$y[dataIL$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataIL$y[dataIL$y == "infant_deaths"] <- "Number of Infant Deaths"
dataIL$y[dataIL$y == "pct_diabetes"] <- "% of County with Diabetes"
dataIL$y[dataIL$y == "# Food Insecure"] <- "# Food Insecurity"
dataIL$y[dataIL$y == "% Food Insecure"] <- "% Food Insecurity"
dataIL$y[dataIL$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataIL$y[dataIL$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataIL$y[dataIL$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataIL$y[dataIL$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataIL$y[dataIL$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataIL$y[dataIL$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataIL$y[dataIL$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataIL$y[dataIL$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataIL$y[dataIL$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataIL$y[dataIL$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataIL$y[dataIL$y == "Denominator"] <- "Estimated Number of Juveniles"
dataIL$y[dataIL$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataIL$y[dataIL$y == "pct_age65"] <- "% of Adults Age 65+"
dataIL$y[dataIL$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataIL$y[dataIL$y == "Assault.death_rate"] <- "Assault Death Rate"
dataIL$y[dataIL$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataIL$y[dataIL$y == "Despair.death_rate"] <- "Despair Death Rate"
dataIL$y[dataIL$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataIL$y[dataIL$y == "COPD"] <- "% of County with COPD"
dataIL$y[dataIL$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataIL$y[dataIL$y == "LungCancer"] <- "% of County with Lung Cancer"

dataIL$y <- factor(dataIL$y, levels = dataIL$y[order(dataIL$x)])

p<-ggplot(dataIL, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .15)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.15)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("IL_desprt.png")
```

Indiana
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "IN"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataIN <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataIN <- dataIN %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataIN$y <- factor(dataIN$y, levels = dataIN$y)

#plot
x <- dataIN$x
x_num<-round(x,digits=2)
dataIN$x_round = x_num

dataIN$y <- as.character(dataIN$y)
dataIN$y[dataIN$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataIN$y[dataIN$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataIN$y[dataIN$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataIN$y[dataIN$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataIN$y[dataIN$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataIN$y[dataIN$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataIN$y[dataIN$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataIN$y[dataIN$y == "% Uninsured"] <- "% of County Uninsured"
dataIN$y[dataIN$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataIN$y[dataIN$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataIN$y[dataIN$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataIN$y[dataIN$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataIN$y[dataIN$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataIN$y[dataIN$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataIN$y[dataIN$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataIN$y[dataIN$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataIN$y[dataIN$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataIN$y[dataIN$y == "Active"] <- "Number of Active COVID-19 Cases"
dataIN$y[dataIN$y == "Lat"] <- "Latitude"
dataIN$y[dataIN$y == "Long_"] <- "Longitude"
dataIN$y[dataIN$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataIN$y[dataIN$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataIN$y[dataIN$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataIN$y[dataIN$y == "poverty"] <- "% Living in Poverty"
dataIN$y[dataIN$y == "popdensity"] <- "Population Density"
dataIN$y[dataIN$y == "medianhousevalue"] <- "Median House Value"
dataIN$y[dataIN$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataIN$y[dataIN$y == "education"] <- "% with less than High-School Education"
dataIN$y[dataIN$y == "population"] <- "Overall Population"
dataIN$y[dataIN$y == "pct_blk"] <- "% African American in County"
dataIN$y[dataIN$y == "hispanic"] <- "% Hispanic in County"
dataIN$y[dataIN$y == "pct_asian"] <- "% Asian in County"
dataIN$y[dataIN$y == "pct_native"] <- "% Native American in County"
dataIN$y[dataIN$y == "pct_white"] <- "% White in County"
dataIN$y[dataIN$y == "q_popdensity"] <- "Population Density"
dataIN$y[dataIN$y == "older_pecent"] <- "% of Population Age 65+"
dataIN$y[dataIN$y == "young_pecent"] <- "% of Population Ages 0-14"
dataIN$y[dataIN$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataIN$y[dataIN$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataIN$y[dataIN$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataIN$y[dataIN$y == "pct_obesity"] <- "% of Adults with Obesity"
dataIN$y[dataIN$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataIN$y[dataIN$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataIN$y[dataIN$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataIN$y[dataIN$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataIN$y[dataIN$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataIN$y[dataIN$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataIN$y[dataIN$y == "infant_deaths"] <- "Number of Infant Deaths"
dataIN$y[dataIN$y == "pct_diabetes"] <- "% of County with Diabetes"
dataIN$y[dataIN$y == "# Food Insecure"] <- "# Food Insecurity"
dataIN$y[dataIN$y == "% Food Insecure"] <- "% Food Insecurity"
dataIN$y[dataIN$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataIN$y[dataIN$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataIN$y[dataIN$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataIN$y[dataIN$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataIN$y[dataIN$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataIN$y[dataIN$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataIN$y[dataIN$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataIN$y[dataIN$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataIN$y[dataIN$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataIN$y[dataIN$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataIN$y[dataIN$y == "Denominator"] <- "Estimated Number of Juveniles"
dataIN$y[dataIN$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataIN$y[dataIN$y == "pct_age65"] <- "% of Adults Age 65+"
dataIN$y[dataIN$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataIN$y[dataIN$y == "Assault.death_rate"] <- "Assault Death Rate"
dataIN$y[dataIN$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataIN$y[dataIN$y == "Despair.death_rate"] <- "Despair Death Rate"
dataIN$y[dataIN$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataIN$y[dataIN$y == "COPD"] <- "% of County with COPD"
dataIN$y[dataIN$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataIN$y[dataIN$y == "LungCancer"] <- "% of County with Lung Cancer"

dataIN$y <- factor(dataIN$y, levels = dataIN$y[order(dataIN$x)])

p<-ggplot(dataIN, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .1)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("IN_desprt.png")
```

Iowa
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "IA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataIA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataIA <- dataIA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataIA$y <- factor(dataIA$y, levels = dataIA$y)

#plot
x <- dataIA$x
x_num<-round(x,digits=2)
dataIA$x_round = x_num

dataIA$y <- as.character(dataIA$y)
dataIA$y[dataIA$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataIA$y[dataIA$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataIA$y[dataIA$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataIA$y[dataIA$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataIA$y[dataIA$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataIA$y[dataIA$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataIA$y[dataIA$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataIA$y[dataIA$y == "% Uninsured"] <- "% of County Uninsured"
dataIA$y[dataIA$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataIA$y[dataIA$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataIA$y[dataIA$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataIA$y[dataIA$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataIA$y[dataIA$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataIA$y[dataIA$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataIA$y[dataIA$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataIA$y[dataIA$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataIA$y[dataIA$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataIA$y[dataIA$y == "Active"] <- "Number of Active COVID-19 Cases"
dataIA$y[dataIA$y == "Lat"] <- "Latitude"
dataIA$y[dataIA$y == "Long_"] <- "Longitude"
dataIA$y[dataIA$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataIA$y[dataIA$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataIA$y[dataIA$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataIA$y[dataIA$y == "poverty"] <- "% Living in Poverty"
dataIA$y[dataIA$y == "popdensity"] <- "Population Density"
dataIA$y[dataIA$y == "medianhousevalue"] <- "Median House Value"
dataIA$y[dataIA$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataIA$y[dataIA$y == "education"] <- "% with less than High-School Education"
dataIA$y[dataIA$y == "population"] <- "Overall Population"
dataIA$y[dataIA$y == "pct_blk"] <- "% African American in County"
dataIA$y[dataIA$y == "hispanic"] <- "% Hispanic in County"
dataIA$y[dataIA$y == "pct_asian"] <- "% Asian in County"
dataIA$y[dataIA$y == "pct_native"] <- "% Native American in County"
dataIA$y[dataIA$y == "pct_white"] <- "% White in County"
dataIA$y[dataIA$y == "q_popdensity"] <- "Population Density"
dataIA$y[dataIA$y == "older_pecent"] <- "% of Population Age 65+"
dataIA$y[dataIA$y == "young_pecent"] <- "% of Population Ages 0-14"
dataIA$y[dataIA$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataIA$y[dataIA$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataIA$y[dataIA$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataIA$y[dataIA$y == "pct_obesity"] <- "% of Adults with Obesity"
dataIA$y[dataIA$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataIA$y[dataIA$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataIA$y[dataIA$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataIA$y[dataIA$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataIA$y[dataIA$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataIA$y[dataIA$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataIA$y[dataIA$y == "infant_deaths"] <- "Number of Infant Deaths"
dataIA$y[dataIA$y == "pct_diabetes"] <- "% of County with Diabetes"
dataIA$y[dataIA$y == "# Food Insecure"] <- "# Food Insecurity"
dataIA$y[dataIA$y == "% Food Insecure"] <- "% Food Insecurity"
dataIA$y[dataIA$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataIA$y[dataIA$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataIA$y[dataIA$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataIA$y[dataIA$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataIA$y[dataIA$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataIA$y[dataIA$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataIA$y[dataIA$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataIA$y[dataIA$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataIA$y[dataIA$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataIA$y[dataIA$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataIA$y[dataIA$y == "Denominator"] <- "Estimated Number of Juveniles"
dataIA$y[dataIA$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataIA$y[dataIA$y == "pct_age65"] <- "% of Adults Age 65+"
dataIA$y[dataIA$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataIA$y[dataIA$y == "Assault.death_rate"] <- "Assault Death Rate"
dataIA$y[dataIA$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataIA$y[dataIA$y == "Despair.death_rate"] <- "Despair Death Rate"
dataIA$y[dataIA$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataIA$y[dataIA$y == "COPD"] <- "% of County with COPD"
dataIA$y[dataIA$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataIA$y[dataIA$y == "LungCancer"] <- "% of County with Lung Cancer"

dataIA$y <- factor(dataIA$y, levels = dataIA$y[order(dataIA$x)])

p<-ggplot(dataIA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=6, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .15)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.15)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("IA_desprt.png")
```

Kansas
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "KS"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataKS <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataKS <- dataKS %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataKS$y <- factor(dataKS$y, levels = dataKS$y)

#plot
x <- dataKS$x
x_num<-round(x,digits=2)
dataKS$x_round = x_num

dataKS$y <- as.character(dataKS$y)
dataKS$y[dataKS$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataKS$y[dataKS$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataKS$y[dataKS$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataKS$y[dataKS$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataKS$y[dataKS$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataKS$y[dataKS$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataKS$y[dataKS$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataKS$y[dataKS$y == "% Uninsured"] <- "% of County Uninsured"
dataKS$y[dataKS$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataKS$y[dataKS$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataKS$y[dataKS$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataKS$y[dataKS$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataKS$y[dataKS$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataKS$y[dataKS$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataKS$y[dataKS$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataKS$y[dataKS$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataKS$y[dataKS$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataKS$y[dataKS$y == "Active"] <- "Number of Active COVID-19 Cases"
dataKS$y[dataKS$y == "Lat"] <- "Latitude"
dataKS$y[dataKS$y == "Long_"] <- "Longitude"
dataKS$y[dataKS$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataKS$y[dataKS$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataKS$y[dataKS$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataKS$y[dataKS$y == "poverty"] <- "% Living in Poverty"
dataKS$y[dataKS$y == "popdensity"] <- "Population Density"
dataKS$y[dataKS$y == "medianhousevalue"] <- "Median House Value"
dataKS$y[dataKS$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataKS$y[dataKS$y == "education"] <- "% with less than High-School Education"
dataKS$y[dataKS$y == "population"] <- "Overall Population"
dataKS$y[dataKS$y == "pct_blk"] <- "% African American in County"
dataKS$y[dataKS$y == "hispanic"] <- "% Hispanic in County"
dataKS$y[dataKS$y == "pct_asian"] <- "% Asian in County"
dataKS$y[dataKS$y == "pct_native"] <- "% Native American in County"
dataKS$y[dataKS$y == "pct_white"] <- "% White in County"
dataKS$y[dataKS$y == "q_popdensity"] <- "Population Density"
dataKS$y[dataKS$y == "older_pecent"] <- "% of Population Age 65+"
dataKS$y[dataKS$y == "young_pecent"] <- "% of Population Ages 0-14"
dataKS$y[dataKS$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataKS$y[dataKS$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataKS$y[dataKS$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataKS$y[dataKS$y == "pct_obesity"] <- "% of Adults with Obesity"
dataKS$y[dataKS$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataKS$y[dataKS$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataKS$y[dataKS$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataKS$y[dataKS$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataKS$y[dataKS$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataKS$y[dataKS$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataKS$y[dataKS$y == "infant_deaths"] <- "Number of Infant Deaths"
dataKS$y[dataKS$y == "pct_diabetes"] <- "% of County with Diabetes"
dataKS$y[dataKS$y == "# Food Insecure"] <- "# Food Insecurity"
dataKS$y[dataKS$y == "% Food Insecure"] <- "% Food Insecurity"
dataKS$y[dataKS$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataKS$y[dataKS$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataKS$y[dataKS$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataKS$y[dataKS$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataKS$y[dataKS$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataKS$y[dataKS$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataKS$y[dataKS$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataKS$y[dataKS$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataKS$y[dataKS$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataKS$y[dataKS$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataKS$y[dataKS$y == "Denominator"] <- "Estimated Number of Juveniles"
dataKS$y[dataKS$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataKS$y[dataKS$y == "pct_age65"] <- "% of Adults Age 65+"
dataKS$y[dataKS$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataKS$y[dataKS$y == "Assault.death_rate"] <- "Assault Death Rate"
dataKS$y[dataKS$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataKS$y[dataKS$y == "Despair.death_rate"] <- "Despair Death Rate"
dataKS$y[dataKS$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataKS$y[dataKS$y == "COPD"] <- "% of County with COPD"
dataKS$y[dataKS$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataKS$y[dataKS$y == "LungCancer"] <- "% of County with Lung Cancer"

dataKS$y <- factor(dataKS$y, levels = dataKS$y[order(dataKS$x)])

p<-ggplot(dataKS, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.15)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("KS_desprt.png")
```

Kentucky
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "KY"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataKY <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataKY <- dataKY %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataKY$y <- factor(dataKY$y, levels = dataKY$y)

#plot
x <- dataKY$x
x_num<-round(x,digits=2)
dataKY$x_round = x_num

dataKY$y <- as.character(dataKY$y)
dataKY$y[dataKY$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataKY$y[dataKY$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataKY$y[dataKY$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataKY$y[dataKY$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataKY$y[dataKY$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataKY$y[dataKY$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataKY$y[dataKY$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataKY$y[dataKY$y == "% Uninsured"] <- "% of County Uninsured"
dataKY$y[dataKY$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataKY$y[dataKY$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataKY$y[dataKY$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataKY$y[dataKY$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataKY$y[dataKY$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataKY$y[dataKY$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataKY$y[dataKY$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataKY$y[dataKY$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataKY$y[dataKY$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataKY$y[dataKY$y == "Active"] <- "Number of Active COVID-19 Cases"
dataKY$y[dataKY$y == "Lat"] <- "Latitude"
dataKY$y[dataKY$y == "Long_"] <- "Longitude"
dataKY$y[dataKY$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataKY$y[dataKY$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataKY$y[dataKY$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataKY$y[dataKY$y == "poverty"] <- "% Living in Poverty"
dataKY$y[dataKY$y == "popdensity"] <- "Population Density"
dataKY$y[dataKY$y == "medianhousevalue"] <- "Median House Value"
dataKY$y[dataKY$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataKY$y[dataKY$y == "education"] <- "% with less than High-School Education"
dataKY$y[dataKY$y == "population"] <- "Overall Population"
dataKY$y[dataKY$y == "pct_blk"] <- "% African American in County"
dataKY$y[dataKY$y == "hispanic"] <- "% Hispanic in County"
dataKY$y[dataKY$y == "pct_asian"] <- "% Asian in County"
dataKY$y[dataKY$y == "pct_native"] <- "% Native American in County"
dataKY$y[dataKY$y == "pct_white"] <- "% White in County"
dataKY$y[dataKY$y == "q_popdensity"] <- "Population Density"
dataKY$y[dataKY$y == "older_pecent"] <- "% of Population Age 65+"
dataKY$y[dataKY$y == "young_pecent"] <- "% of Population Ages 0-14"
dataKY$y[dataKY$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataKY$y[dataKY$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataKY$y[dataKY$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataKY$y[dataKY$y == "pct_obesity"] <- "% of Adults with Obesity"
dataKY$y[dataKY$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataKY$y[dataKY$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataKY$y[dataKY$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataKY$y[dataKY$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataKY$y[dataKY$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataKY$y[dataKY$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataKY$y[dataKY$y == "infant_deaths"] <- "Number of Infant Deaths"
dataKY$y[dataKY$y == "pct_diabetes"] <- "% of County with Diabetes"
dataKY$y[dataKY$y == "# Food Insecure"] <- "# Food Insecurity"
dataKY$y[dataKY$y == "% Food Insecure"] <- "% Food Insecurity"
dataKY$y[dataKY$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataKY$y[dataKY$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataKY$y[dataKY$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataKY$y[dataKY$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataKY$y[dataKY$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataKY$y[dataKY$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataKY$y[dataKY$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataKY$y[dataKY$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataKY$y[dataKY$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataKY$y[dataKY$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataKY$y[dataKY$y == "Denominator"] <- "Estimated Number of Juveniles"
dataKY$y[dataKY$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataKY$y[dataKY$y == "pct_age65"] <- "% of Adults Age 65+"
dataKY$y[dataKY$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataKY$y[dataKY$y == "Assault.death_rate"] <- "Assault Death Rate"
dataKY$y[dataKY$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataKY$y[dataKY$y == "Despair.death_rate"] <- "Despair Death Rate"
dataKY$y[dataKY$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataKY$y[dataKY$y == "COPD"] <- "% of County with COPD"
dataKY$y[dataKY$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataKY$y[dataKY$y == "LungCancer"] <- "% of County with Lung Cancer"

dataKY$y <- factor(dataKY$y, levels = dataKY$y[order(dataKY$x)])

p<-ggplot(dataKY, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=6.5, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .15)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.15)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("KY_desprt.png")
```

Louisiana
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "LA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataLA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataLA <- dataLA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataLA$y <- factor(dataLA$y, levels = dataLA$y)

#plot
x <- dataLA$x
x_num<-round(x,digits=2)
dataLA$x_round = x_num

dataLA$y <- as.character(dataLA$y)
dataLA$y[dataLA$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataLA$y[dataLA$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataLA$y[dataLA$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataLA$y[dataLA$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataLA$y[dataLA$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataLA$y[dataLA$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataLA$y[dataLA$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataLA$y[dataLA$y == "% Uninsured"] <- "% of County Uninsured"
dataLA$y[dataLA$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataLA$y[dataLA$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataLA$y[dataLA$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataLA$y[dataLA$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataLA$y[dataLA$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataLA$y[dataLA$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataLA$y[dataLA$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataLA$y[dataLA$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataLA$y[dataLA$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataLA$y[dataLA$y == "Active"] <- "Number of Active COVID-19 Cases"
dataLA$y[dataLA$y == "Lat"] <- "Latitude"
dataLA$y[dataLA$y == "Long_"] <- "Longitude"
dataLA$y[dataLA$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataLA$y[dataLA$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataLA$y[dataLA$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataLA$y[dataLA$y == "poverty"] <- "% Living in Poverty"
dataLA$y[dataLA$y == "popdensity"] <- "Population Density"
dataLA$y[dataLA$y == "medianhousevalue"] <- "Median House Value"
dataLA$y[dataLA$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataLA$y[dataLA$y == "education"] <- "% with less than High-School Education"
dataLA$y[dataLA$y == "population"] <- "Overall Population"
dataLA$y[dataLA$y == "pct_blk"] <- "% African American in County"
dataLA$y[dataLA$y == "hispanic"] <- "% Hispanic in County"
dataLA$y[dataLA$y == "pct_asian"] <- "% Asian in County"
dataLA$y[dataLA$y == "pct_native"] <- "% Native American in County"
dataLA$y[dataLA$y == "pct_white"] <- "% White in County"
dataLA$y[dataLA$y == "q_popdensity"] <- "Population Density"
dataLA$y[dataLA$y == "older_pecent"] <- "% of Population Age 65+"
dataLA$y[dataLA$y == "young_pecent"] <- "% of Population Ages 0-14"
dataLA$y[dataLA$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataLA$y[dataLA$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataLA$y[dataLA$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataLA$y[dataLA$y == "pct_obesity"] <- "% of Adults with Obesity"
dataLA$y[dataLA$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataLA$y[dataLA$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataLA$y[dataLA$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataLA$y[dataLA$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataLA$y[dataLA$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataLA$y[dataLA$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataLA$y[dataLA$y == "infant_deaths"] <- "Number of Infant Deaths"
dataLA$y[dataLA$y == "pct_diabetes"] <- "% of County with Diabetes"
dataLA$y[dataLA$y == "# Food Insecure"] <- "# Food Insecurity"
dataLA$y[dataLA$y == "% Food Insecure"] <- "% Food Insecurity"
dataLA$y[dataLA$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataLA$y[dataLA$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataLA$y[dataLA$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataLA$y[dataLA$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataLA$y[dataLA$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataLA$y[dataLA$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataLA$y[dataLA$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataLA$y[dataLA$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataLA$y[dataLA$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataLA$y[dataLA$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataLA$y[dataLA$y == "Denominator"] <- "Estimated Number of Juveniles"
dataLA$y[dataLA$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataLA$y[dataLA$y == "pct_age65"] <- "% of Adults Age 65+"
dataLA$y[dataLA$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataLA$y[dataLA$y == "Assault.death_rate"] <- "Assault Death Rate"
dataLA$y[dataLA$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataLA$y[dataLA$y == "Despair.death_rate"] <- "Despair Death Rate"
dataLA$y[dataLA$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataLA$y[dataLA$y == "COPD"] <- "% of County with COPD"
dataLA$y[dataLA$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataLA$y[dataLA$y == "LungCancer"] <- "% of County with Lung Cancer"

dataLA$y <- factor(dataLA$y, levels = dataLA$y[order(dataLA$x)])

p<-ggplot(dataLA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .12)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.12)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("LA_desprt.png")
```

Maine (not enough)
```{r}
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))

ggsave("ME_desprt.png")
```

Maryland (not enough)
```{r}
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))

ggsave("MD_desprt.png")
```

Massachusetts (not enough)
```{r}
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))

ggsave("MA_desprt.png")
```

Michigan
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "MI"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataMI <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataMI <- dataMI %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataMI$y <- factor(dataMI$y, levels = dataMI$y)

#plot
x <- dataMI$x
x_num<-round(x,digits=2)
dataMI$x_round = x_num

dataMI$y <- as.character(dataMI$y)
dataMI$y[dataMI$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataMI$y[dataMI$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataMI$y[dataMI$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataMI$y[dataMI$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataMI$y[dataMI$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataMI$y[dataMI$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataMI$y[dataMI$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataMI$y[dataMI$y == "% Uninsured"] <- "% of County Uninsured"
dataMI$y[dataMI$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataMI$y[dataMI$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataMI$y[dataMI$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataMI$y[dataMI$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataMI$y[dataMI$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataMI$y[dataMI$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataMI$y[dataMI$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataMI$y[dataMI$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataMI$y[dataMI$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataMI$y[dataMI$y == "Active"] <- "Number of Active COVID-19 Cases"
dataMI$y[dataMI$y == "Lat"] <- "Latitude"
dataMI$y[dataMI$y == "Long_"] <- "Longitude"
dataMI$y[dataMI$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataMI$y[dataMI$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataMI$y[dataMI$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataMI$y[dataMI$y == "poverty"] <- "% Living in Poverty"
dataMI$y[dataMI$y == "popdensity"] <- "Population Density"
dataMI$y[dataMI$y == "medianhousevalue"] <- "Median House Value"
dataMI$y[dataMI$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataMI$y[dataMI$y == "education"] <- "% with less than High-School Education"
dataMI$y[dataMI$y == "population"] <- "Overall Population"
dataMI$y[dataMI$y == "pct_blk"] <- "% African American in County"
dataMI$y[dataMI$y == "hispanic"] <- "% Hispanic in County"
dataMI$y[dataMI$y == "pct_asian"] <- "% Asian in County"
dataMI$y[dataMI$y == "pct_native"] <- "% Native American in County"
dataMI$y[dataMI$y == "pct_white"] <- "% White in County"
dataMI$y[dataMI$y == "q_popdensity"] <- "Population Density"
dataMI$y[dataMI$y == "older_pecent"] <- "% of Population Age 65+"
dataMI$y[dataMI$y == "young_pecent"] <- "% of Population Ages 0-14"
dataMI$y[dataMI$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataMI$y[dataMI$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataMI$y[dataMI$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataMI$y[dataMI$y == "pct_obesity"] <- "% of Adults with Obesity"
dataMI$y[dataMI$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataMI$y[dataMI$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataMI$y[dataMI$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataMI$y[dataMI$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataMI$y[dataMI$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataMI$y[dataMI$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataMI$y[dataMI$y == "infant_deaths"] <- "Number of Infant Deaths"
dataMI$y[dataMI$y == "pct_diabetes"] <- "% of County with Diabetes"
dataMI$y[dataMI$y == "# Food Insecure"] <- "# Food Insecurity"
dataMI$y[dataMI$y == "% Food Insecure"] <- "% Food Insecurity"
dataMI$y[dataMI$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataMI$y[dataMI$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataMI$y[dataMI$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataMI$y[dataMI$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataMI$y[dataMI$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataMI$y[dataMI$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataMI$y[dataMI$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataMI$y[dataMI$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataMI$y[dataMI$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataMI$y[dataMI$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataMI$y[dataMI$y == "Denominator"] <- "Estimated Number of Juveniles"
dataMI$y[dataMI$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataMI$y[dataMI$y == "pct_age65"] <- "% of Adults Age 65+"
dataMI$y[dataMI$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataMI$y[dataMI$y == "Assault.death_rate"] <- "Assault Death Rate"
dataMI$y[dataMI$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataMI$y[dataMI$y == "Despair.death_rate"] <- "Despair Death Rate"
dataMI$y[dataMI$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataMI$y[dataMI$y == "COPD"] <- "% of County with COPD"
dataMI$y[dataMI$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataMI$y[dataMI$y == "LungCancer"] <- "% of County with Lung Cancer"

dataMI$y <- factor(dataMI$y, levels = dataMI$y[order(dataMI$x)])

p<-ggplot(dataMI, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("MI_desprt.png")
```

Minnesota
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "MN"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataMN <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataMN <- dataMN %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataMN$y <- factor(dataMN$y, levels = dataMN$y)

#plot
x <- dataMN$x
x_num<-round(x,digits=2)
dataMN$x_round = x_num

dataMN$y <- as.character(dataMN$y)
dataMN$y[dataMN$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataMN$y[dataMN$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataMN$y[dataMN$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataMN$y[dataMN$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataMN$y[dataMN$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataMN$y[dataMN$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataMN$y[dataMN$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataMN$y[dataMN$y == "% Uninsured"] <- "% of County Uninsured"
dataMN$y[dataMN$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataMN$y[dataMN$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataMN$y[dataMN$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataMN$y[dataMN$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataMN$y[dataMN$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataMN$y[dataMN$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataMN$y[dataMN$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataMN$y[dataMN$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataMN$y[dataMN$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataMN$y[dataMN$y == "Active"] <- "Number of Active COVID-19 Cases"
dataMN$y[dataMN$y == "Lat"] <- "Latitude"
dataMN$y[dataMN$y == "Long_"] <- "Longitude"
dataMN$y[dataMN$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataMN$y[dataMN$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataMN$y[dataMN$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataMN$y[dataMN$y == "poverty"] <- "% Living in Poverty"
dataMN$y[dataMN$y == "popdensity"] <- "Population Density"
dataMN$y[dataMN$y == "medianhousevalue"] <- "Median House Value"
dataMN$y[dataMN$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataMN$y[dataMN$y == "education"] <- "% with less than High-School Education"
dataMN$y[dataMN$y == "population"] <- "Overall Population"
dataMN$y[dataMN$y == "pct_blk"] <- "% African American in County"
dataMN$y[dataMN$y == "hispanic"] <- "% Hispanic in County"
dataMN$y[dataMN$y == "pct_asian"] <- "% Asian in County"
dataMN$y[dataMN$y == "pct_native"] <- "% Native American in County"
dataMN$y[dataMN$y == "pct_white"] <- "% White in County"
dataMN$y[dataMN$y == "q_popdensity"] <- "Population Density"
dataMN$y[dataMN$y == "older_pecent"] <- "% of Population Age 65+"
dataMN$y[dataMN$y == "young_pecent"] <- "% of Population Ages 0-14"
dataMN$y[dataMN$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataMN$y[dataMN$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataMN$y[dataMN$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataMN$y[dataMN$y == "pct_obesity"] <- "% of Adults with Obesity"
dataMN$y[dataMN$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataMN$y[dataMN$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataMN$y[dataMN$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataMN$y[dataMN$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataMN$y[dataMN$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataMN$y[dataMN$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataMN$y[dataMN$y == "infant_deaths"] <- "Number of Infant Deaths"
dataMN$y[dataMN$y == "pct_diabetes"] <- "% of County with Diabetes"
dataMN$y[dataMN$y == "# Food Insecure"] <- "# Food Insecurity"
dataMN$y[dataMN$y == "% Food Insecure"] <- "% Food Insecurity"
dataMN$y[dataMN$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataMN$y[dataMN$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataMN$y[dataMN$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataMN$y[dataMN$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataMN$y[dataMN$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataMN$y[dataMN$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataMN$y[dataMN$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataMN$y[dataMN$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataMN$y[dataMN$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataMN$y[dataMN$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataMN$y[dataMN$y == "Denominator"] <- "Estimated Number of Juveniles"
dataMN$y[dataMN$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataMN$y[dataMN$y == "pct_age65"] <- "% of Adults Age 65+"
dataMN$y[dataMN$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataMN$y[dataMN$y == "Assault.death_rate"] <- "Assault Death Rate"
dataMN$y[dataMN$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataMN$y[dataMN$y == "Despair.death_rate"] <- "Despair Death Rate"
dataMN$y[dataMN$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataMN$y[dataMN$y == "COPD"] <- "% of County with COPD"
dataMN$y[dataMN$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataMN$y[dataMN$y == "LungCancer"] <- "% of County with Lung Cancer"

dataMN$y <- factor(dataMN$y, levels = dataMN$y[order(dataMN$x)])

p<-ggplot(dataMN, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .1)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("MN_desprt.png")
```

Mississippi
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "MS"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataMS <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataMS <- dataMS %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataMS$y <- factor(dataMS$y, levels = dataMS$y)

#plot
x <- dataMS$x
x_num<-round(x,digits=2)
dataMS$x_round = x_num

dataMS$y <- as.character(dataMS$y)
dataMS$y[dataMS$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataMS$y[dataMS$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataMS$y[dataMS$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataMS$y[dataMS$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataMS$y[dataMS$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataMS$y[dataMS$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataMS$y[dataMS$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataMS$y[dataMS$y == "% Uninsured"] <- "% of County Uninsured"
dataMS$y[dataMS$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataMS$y[dataMS$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataMS$y[dataMS$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataMS$y[dataMS$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataMS$y[dataMS$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataMS$y[dataMS$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataMS$y[dataMS$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataMS$y[dataMS$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataMS$y[dataMS$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataMS$y[dataMS$y == "Active"] <- "Number of Active COVID-19 Cases"
dataMS$y[dataMS$y == "Lat"] <- "Latitude"
dataMS$y[dataMS$y == "Long_"] <- "Longitude"
dataMS$y[dataMS$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataMS$y[dataMS$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataMS$y[dataMS$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataMS$y[dataMS$y == "poverty"] <- "% Living in Poverty"
dataMS$y[dataMS$y == "popdensity"] <- "Population Density"
dataMS$y[dataMS$y == "medianhousevalue"] <- "Median House Value"
dataMS$y[dataMS$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataMS$y[dataMS$y == "education"] <- "% with less than High-School Education"
dataMS$y[dataMS$y == "population"] <- "Overall Population"
dataMS$y[dataMS$y == "pct_blk"] <- "% African American in County"
dataMS$y[dataMS$y == "hispanic"] <- "% Hispanic in County"
dataMS$y[dataMS$y == "pct_asian"] <- "% Asian in County"
dataMS$y[dataMS$y == "pct_native"] <- "% Native American in County"
dataMS$y[dataMS$y == "pct_white"] <- "% White in County"
dataMS$y[dataMS$y == "q_popdensity"] <- "Population Density"
dataMS$y[dataMS$y == "older_pecent"] <- "% of Population Age 65+"
dataMS$y[dataMS$y == "young_pecent"] <- "% of Population Ages 0-14"
dataMS$y[dataMS$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataMS$y[dataMS$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataMS$y[dataMS$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataMS$y[dataMS$y == "pct_obesity"] <- "% of Adults with Obesity"
dataMS$y[dataMS$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataMS$y[dataMS$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataMS$y[dataMS$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataMS$y[dataMS$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataMS$y[dataMS$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataMS$y[dataMS$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataMS$y[dataMS$y == "infant_deaths"] <- "Number of Infant Deaths"
dataMS$y[dataMS$y == "pct_diabetes"] <- "% of County with Diabetes"
dataMS$y[dataMS$y == "# Food Insecure"] <- "# Food Insecurity"
dataMS$y[dataMS$y == "% Food Insecure"] <- "% Food Insecurity"
dataMS$y[dataMS$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataMS$y[dataMS$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataMS$y[dataMS$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataMS$y[dataMS$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataMS$y[dataMS$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataMS$y[dataMS$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataMS$y[dataMS$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataMS$y[dataMS$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataMS$y[dataMS$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataMS$y[dataMS$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataMS$y[dataMS$y == "Denominator"] <- "Estimated Number of Juveniles"
dataMS$y[dataMS$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataMS$y[dataMS$y == "pct_age65"] <- "% of Adults Age 65+"
dataMS$y[dataMS$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataMS$y[dataMS$y == "Assault.death_rate"] <- "Assault Death Rate"
dataMS$y[dataMS$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataMS$y[dataMS$y == "Despair.death_rate"] <- "Despair Death Rate"
dataMS$y[dataMS$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataMS$y[dataMS$y == "COPD"] <- "% of County with COPD"
dataMS$y[dataMS$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataMS$y[dataMS$y == "LungCancer"] <- "% of County with Lung Cancer"

dataMS$y <- factor(dataMS$y, levels = dataMS$y[order(dataMS$x)])

p<-ggplot(dataMS, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.04)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("MS_desprt.png")
```

Missouri
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "MO"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataMO <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataMO <- dataMO %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataMO$y <- factor(dataMO$y, levels = dataMO$y)

#plot
x <- dataMO$x
x_num<-round(x,digits=2)
dataMO$x_round = x_num

dataMO$y <- as.character(dataMO$y)
dataMO$y[dataMO$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataMO$y[dataMO$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataMO$y[dataMO$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataMO$y[dataMO$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataMO$y[dataMO$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataMO$y[dataMO$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataMO$y[dataMO$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataMO$y[dataMO$y == "% Uninsured"] <- "% of County Uninsured"
dataMO$y[dataMO$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataMO$y[dataMO$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataMO$y[dataMO$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataMO$y[dataMO$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataMO$y[dataMO$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataMO$y[dataMO$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataMO$y[dataMO$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataMO$y[dataMO$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataMO$y[dataMO$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataMO$y[dataMO$y == "Active"] <- "Number of Active COVID-19 Cases"
dataMO$y[dataMO$y == "Lat"] <- "Latitude"
dataMO$y[dataMO$y == "Long_"] <- "Longitude"
dataMO$y[dataMO$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataMO$y[dataMO$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataMO$y[dataMO$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataMO$y[dataMO$y == "poverty"] <- "% Living in Poverty"
dataMO$y[dataMO$y == "popdensity"] <- "Population Density"
dataMO$y[dataMO$y == "medianhousevalue"] <- "Median House Value"
dataMO$y[dataMO$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataMO$y[dataMO$y == "education"] <- "% with less than High-School Education"
dataMO$y[dataMO$y == "population"] <- "Overall Population"
dataMO$y[dataMO$y == "pct_blk"] <- "% African American in County"
dataMO$y[dataMO$y == "hispanic"] <- "% Hispanic in County"
dataMO$y[dataMO$y == "pct_asian"] <- "% Asian in County"
dataMO$y[dataMO$y == "pct_native"] <- "% Native American in County"
dataMO$y[dataMO$y == "pct_white"] <- "% White in County"
dataMO$y[dataMO$y == "q_popdensity"] <- "Population Density"
dataMO$y[dataMO$y == "older_pecent"] <- "% of Population Age 65+"
dataMO$y[dataMO$y == "young_pecent"] <- "% of Population Ages 0-14"
dataMO$y[dataMO$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataMO$y[dataMO$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataMO$y[dataMO$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataMO$y[dataMO$y == "pct_obesity"] <- "% of Adults with Obesity"
dataMO$y[dataMO$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataMO$y[dataMO$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataMO$y[dataMO$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataMO$y[dataMO$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataMO$y[dataMO$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataMO$y[dataMO$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataMO$y[dataMO$y == "infant_deaths"] <- "Number of Infant Deaths"
dataMO$y[dataMO$y == "pct_diabetes"] <- "% of County with Diabetes"
dataMO$y[dataMO$y == "# Food Insecure"] <- "# Food Insecurity"
dataMO$y[dataMO$y == "% Food Insecure"] <- "% Food Insecurity"
dataMO$y[dataMO$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataMO$y[dataMO$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataMO$y[dataMO$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataMO$y[dataMO$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataMO$y[dataMO$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataMO$y[dataMO$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataMO$y[dataMO$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataMO$y[dataMO$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataMO$y[dataMO$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataMO$y[dataMO$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataMO$y[dataMO$y == "Denominator"] <- "Estimated Number of Juveniles"
dataMO$y[dataMO$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataMO$y[dataMO$y == "pct_age65"] <- "% of Adults Age 65+"
dataMO$y[dataMO$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataMO$y[dataMO$y == "Assault.death_rate"] <- "Assault Death Rate"
dataMO$y[dataMO$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataMO$y[dataMO$y == "Despair.death_rate"] <- "Despair Death Rate"
dataMO$y[dataMO$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataMO$y[dataMO$y == "COPD"] <- "% of County with COPD"
dataMO$y[dataMO$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataMO$y[dataMO$y == "LungCancer"] <- "% of County with Lung Cancer"

dataMO$y <- factor(dataMO$y, levels = dataMO$y[order(dataMO$x)])

p<-ggplot(dataMO, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=7, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .18)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.18)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("MO_desprt.png")
```

Montana
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "MT"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataMT <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataMT <- dataMT %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataMT$y <- factor(dataMT$y, levels = dataMT$y)

#plot
x <- dataMT$x
x_num<-round(x,digits=2)
dataMT$x_round = x_num

dataMT$y <- as.character(dataMT$y)
dataMT$y[dataMT$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataMT$y[dataMT$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataMT$y[dataMT$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataMT$y[dataMT$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataMT$y[dataMT$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataMT$y[dataMT$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataMT$y[dataMT$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataMT$y[dataMT$y == "% Uninsured"] <- "% of County Uninsured"
dataMT$y[dataMT$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataMT$y[dataMT$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataMT$y[dataMT$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataMT$y[dataMT$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataMT$y[dataMT$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataMT$y[dataMT$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataMT$y[dataMT$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataMT$y[dataMT$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataMT$y[dataMT$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataMT$y[dataMT$y == "Active"] <- "Number of Active COVID-19 Cases"
dataMT$y[dataMT$y == "Lat"] <- "Latitude"
dataMT$y[dataMT$y == "Long_"] <- "Longitude"
dataMT$y[dataMT$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataMT$y[dataMT$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataMT$y[dataMT$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataMT$y[dataMT$y == "poverty"] <- "% Living in Poverty"
dataMT$y[dataMT$y == "popdensity"] <- "Population Density"
dataMT$y[dataMT$y == "medianhousevalue"] <- "Median House Value"
dataMT$y[dataMT$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataMT$y[dataMT$y == "education"] <- "% with less than High-School Education"
dataMT$y[dataMT$y == "population"] <- "Overall Population"
dataMT$y[dataMT$y == "pct_blk"] <- "% African American in County"
dataMT$y[dataMT$y == "hispanic"] <- "% Hispanic in County"
dataMT$y[dataMT$y == "pct_asian"] <- "% Asian in County"
dataMT$y[dataMT$y == "pct_native"] <- "% Native American in County"
dataMT$y[dataMT$y == "pct_white"] <- "% White in County"
dataMT$y[dataMT$y == "q_popdensity"] <- "Population Density"
dataMT$y[dataMT$y == "older_pecent"] <- "% of Population Age 65+"
dataMT$y[dataMT$y == "young_pecent"] <- "% of Population Ages 0-14"
dataMT$y[dataMT$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataMT$y[dataMT$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataMT$y[dataMT$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataMT$y[dataMT$y == "pct_obesity"] <- "% of Adults with Obesity"
dataMT$y[dataMT$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataMT$y[dataMT$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataMT$y[dataMT$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataMT$y[dataMT$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataMT$y[dataMT$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataMT$y[dataMT$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataMT$y[dataMT$y == "infant_deaths"] <- "Number of Infant Deaths"
dataMT$y[dataMT$y == "pct_diabetes"] <- "% of County with Diabetes"
dataMT$y[dataMT$y == "# Food Insecure"] <- "# Food Insecurity"
dataMT$y[dataMT$y == "% Food Insecure"] <- "% Food Insecurity"
dataMT$y[dataMT$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataMT$y[dataMT$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataMT$y[dataMT$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataMT$y[dataMT$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataMT$y[dataMT$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataMT$y[dataMT$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataMT$y[dataMT$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataMT$y[dataMT$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataMT$y[dataMT$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataMT$y[dataMT$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataMT$y[dataMT$y == "Denominator"] <- "Estimated Number of Juveniles"
dataMT$y[dataMT$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataMT$y[dataMT$y == "pct_age65"] <- "% of Adults Age 65+"
dataMT$y[dataMT$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataMT$y[dataMT$y == "Assault.death_rate"] <- "Assault Death Rate"
dataMT$y[dataMT$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataMT$y[dataMT$y == "Despair.death_rate"] <- "Despair Death Rate"
dataMT$y[dataMT$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataMT$y[dataMT$y == "COPD"] <- "% of County with COPD"
dataMT$y[dataMT$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataMT$y[dataMT$y == "LungCancer"] <- "% of County with Lung Cancer"

dataMT$y <- factor(dataMT$y, levels = dataMT$y[order(dataMT$x)])

p<-ggplot(dataMT, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("MT_desprt.png")
```

Nebraska
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "NE"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataNE <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataNE <- dataNE %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataNE$y <- factor(dataNE$y, levels = dataNE$y)

#plot
x <- dataNE$x
x_num<-round(x,digits=2)
dataNE$x_round = x_num

dataNE$y <- as.character(dataNE$y)
dataNE$y[dataNE$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataNE$y[dataNE$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataNE$y[dataNE$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataNE$y[dataNE$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataNE$y[dataNE$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataNE$y[dataNE$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataNE$y[dataNE$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataNE$y[dataNE$y == "% Uninsured"] <- "% of County Uninsured"
dataNE$y[dataNE$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataNE$y[dataNE$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataNE$y[dataNE$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataNE$y[dataNE$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataNE$y[dataNE$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataNE$y[dataNE$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataNE$y[dataNE$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataNE$y[dataNE$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataNE$y[dataNE$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataNE$y[dataNE$y == "Active"] <- "Number of Active COVID-19 Cases"
dataNE$y[dataNE$y == "Lat"] <- "Latitude"
dataNE$y[dataNE$y == "Long_"] <- "Longitude"
dataNE$y[dataNE$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataNE$y[dataNE$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataNE$y[dataNE$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataNE$y[dataNE$y == "poverty"] <- "% Living in Poverty"
dataNE$y[dataNE$y == "popdensity"] <- "Population Density"
dataNE$y[dataNE$y == "medianhousevalue"] <- "Median House Value"
dataNE$y[dataNE$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataNE$y[dataNE$y == "education"] <- "% with less than High-School Education"
dataNE$y[dataNE$y == "population"] <- "Overall Population"
dataNE$y[dataNE$y == "pct_blk"] <- "% African American in County"
dataNE$y[dataNE$y == "hispanic"] <- "% Hispanic in County"
dataNE$y[dataNE$y == "pct_asian"] <- "% Asian in County"
dataNE$y[dataNE$y == "pct_native"] <- "% Native American in County"
dataNE$y[dataNE$y == "pct_white"] <- "% White in County"
dataNE$y[dataNE$y == "q_popdensity"] <- "Population Density"
dataNE$y[dataNE$y == "older_pecent"] <- "% of Population Age 65+"
dataNE$y[dataNE$y == "young_pecent"] <- "% of Population Ages 0-14"
dataNE$y[dataNE$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataNE$y[dataNE$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataNE$y[dataNE$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataNE$y[dataNE$y == "pct_obesity"] <- "% of Adults with Obesity"
dataNE$y[dataNE$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataNE$y[dataNE$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataNE$y[dataNE$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataNE$y[dataNE$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataNE$y[dataNE$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataNE$y[dataNE$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataNE$y[dataNE$y == "infant_deaths"] <- "Number of Infant Deaths"
dataNE$y[dataNE$y == "pct_diabetes"] <- "% of County with Diabetes"
dataNE$y[dataNE$y == "# Food Insecure"] <- "# Food Insecurity"
dataNE$y[dataNE$y == "% Food Insecure"] <- "% Food Insecurity"
dataNE$y[dataNE$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataNE$y[dataNE$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataNE$y[dataNE$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataNE$y[dataNE$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataNE$y[dataNE$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataNE$y[dataNE$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataNE$y[dataNE$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataNE$y[dataNE$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataNE$y[dataNE$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataNE$y[dataNE$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataNE$y[dataNE$y == "Denominator"] <- "Estimated Number of Juveniles"
dataNE$y[dataNE$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataNE$y[dataNE$y == "pct_age65"] <- "% of Adults Age 65+"
dataNE$y[dataNE$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataNE$y[dataNE$y == "Assault.death_rate"] <- "Assault Death Rate"
dataNE$y[dataNE$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataNE$y[dataNE$y == "Despair.death_rate"] <- "Despair Death Rate"
dataNE$y[dataNE$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataNE$y[dataNE$y == "COPD"] <- "% of County with COPD"
dataNE$y[dataNE$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataNE$y[dataNE$y == "LungCancer"] <- "% of County with Lung Cancer"

dataNE$y <- factor(dataNE$y, levels = dataNE$y[order(dataNE$x)])

p<-ggplot(dataNE, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("NE_desprt.png")
```

Nevada (not enough)
```{r}
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))

ggsave("NV_desprt.png")
```

New Hampshire (not enough)
```{r}
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))

ggsave("NH_desprt.png")
```

New Jersey (not enough)
```{r}
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))

ggsave("NJ_desprt.png")
```

New Mexico
```{r echo = F}
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))

ggsave("NM_desprt.png")
```

New York
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "NY"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataNY <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataNY <- dataNY %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataNY$y <- factor(dataNY$y, levels = dataNY$y)

#plot
x <- dataNY$x
x_num<-round(x,digits=2)
dataNY$x_round = x_num

dataNY$y <- as.character(dataNY$y)
dataNY$y[dataNY$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataNY$y[dataNY$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataNY$y[dataNY$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataNY$y[dataNY$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataNY$y[dataNY$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataNY$y[dataNY$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataNY$y[dataNY$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataNY$y[dataNY$y == "% Uninsured"] <- "% of County Uninsured"
dataNY$y[dataNY$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataNY$y[dataNY$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataNY$y[dataNY$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataNY$y[dataNY$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataNY$y[dataNY$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataNY$y[dataNY$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataNY$y[dataNY$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataNY$y[dataNY$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataNY$y[dataNY$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataNY$y[dataNY$y == "Active"] <- "Number of Active COVID-19 Cases"
dataNY$y[dataNY$y == "Lat"] <- "Latitude"
dataNY$y[dataNY$y == "Long_"] <- "Longitude"
dataNY$y[dataNY$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataNY$y[dataNY$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataNY$y[dataNY$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataNY$y[dataNY$y == "poverty"] <- "% Living in Poverty"
dataNY$y[dataNY$y == "popdensity"] <- "Population Density"
dataNY$y[dataNY$y == "medianhousevalue"] <- "Median House Value"
dataNY$y[dataNY$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataNY$y[dataNY$y == "education"] <- "% with less than High-School Education"
dataNY$y[dataNY$y == "population"] <- "Overall Population"
dataNY$y[dataNY$y == "pct_blk"] <- "% African American in County"
dataNY$y[dataNY$y == "hispanic"] <- "% Hispanic in County"
dataNY$y[dataNY$y == "pct_asian"] <- "% Asian in County"
dataNY$y[dataNY$y == "pct_native"] <- "% Native American in County"
dataNY$y[dataNY$y == "pct_white"] <- "% White in County"
dataNY$y[dataNY$y == "q_popdensity"] <- "Population Density"
dataNY$y[dataNY$y == "older_pecent"] <- "% of Population Age 65+"
dataNY$y[dataNY$y == "young_pecent"] <- "% of Population Ages 0-14"
dataNY$y[dataNY$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataNY$y[dataNY$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataNY$y[dataNY$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataNY$y[dataNY$y == "pct_obesity"] <- "% of Adults with Obesity"
dataNY$y[dataNY$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataNY$y[dataNY$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataNY$y[dataNY$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataNY$y[dataNY$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataNY$y[dataNY$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataNY$y[dataNY$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataNY$y[dataNY$y == "infant_deaths"] <- "Number of Infant Deaths"
dataNY$y[dataNY$y == "pct_diabetes"] <- "% of County with Diabetes"
dataNY$y[dataNY$y == "# Food Insecure"] <- "# Food Insecurity"
dataNY$y[dataNY$y == "% Food Insecure"] <- "% Food Insecurity"
dataNY$y[dataNY$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataNY$y[dataNY$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataNY$y[dataNY$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataNY$y[dataNY$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataNY$y[dataNY$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataNY$y[dataNY$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataNY$y[dataNY$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataNY$y[dataNY$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataNY$y[dataNY$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataNY$y[dataNY$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataNY$y[dataNY$y == "Denominator"] <- "Estimated Number of Juveniles"
dataNY$y[dataNY$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataNY$y[dataNY$y == "pct_age65"] <- "% of Adults Age 65+"
dataNY$y[dataNY$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataNY$y[dataNY$y == "Assault.death_rate"] <- "Assault Death Rate"
dataNY$y[dataNY$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataNY$y[dataNY$y == "Despair.death_rate"] <- "Despair Death Rate"
dataNY$y[dataNY$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataNY$y[dataNY$y == "COPD"] <- "% of County with COPD"
dataNY$y[dataNY$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataNY$y[dataNY$y == "LungCancer"] <- "% of County with Lung Cancer"

dataNY$y <- factor(dataNY$y, levels = dataNY$y[order(dataNY$x)])

p<-ggplot(dataNY, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.3)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("NY_desprt.png")
```

North Carolina
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "NC"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataNC <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataNC <- dataNC %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataNC$y <- factor(dataNC$y, levels = dataNC$y)

#plot
x <- dataNC$x
x_num<-round(x,digits=2)
dataNC$x_round = x_num

dataNC$y <- as.character(dataNC$y)
dataNC$y[dataNC$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataNC$y[dataNC$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataNC$y[dataNC$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataNC$y[dataNC$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataNC$y[dataNC$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataNC$y[dataNC$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataNC$y[dataNC$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataNC$y[dataNC$y == "% Uninsured"] <- "% of County Uninsured"
dataNC$y[dataNC$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataNC$y[dataNC$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataNC$y[dataNC$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataNC$y[dataNC$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataNC$y[dataNC$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataNC$y[dataNC$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataNC$y[dataNC$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataNC$y[dataNC$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataNC$y[dataNC$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataNC$y[dataNC$y == "Active"] <- "Number of Active COVID-19 Cases"
dataNC$y[dataNC$y == "Lat"] <- "Latitude"
dataNC$y[dataNC$y == "Long_"] <- "Longitude"
dataNC$y[dataNC$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataNC$y[dataNC$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataNC$y[dataNC$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataNC$y[dataNC$y == "poverty"] <- "% Living in Poverty"
dataNC$y[dataNC$y == "popdensity"] <- "Population Density"
dataNC$y[dataNC$y == "medianhousevalue"] <- "Median House Value"
dataNC$y[dataNC$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataNC$y[dataNC$y == "education"] <- "% with less than High-School Education"
dataNC$y[dataNC$y == "population"] <- "Overall Population"
dataNC$y[dataNC$y == "pct_blk"] <- "% African American in County"
dataNC$y[dataNC$y == "hispanic"] <- "% Hispanic in County"
dataNC$y[dataNC$y == "pct_asian"] <- "% Asian in County"
dataNC$y[dataNC$y == "pct_native"] <- "% Native American in County"
dataNC$y[dataNC$y == "pct_white"] <- "% White in County"
dataNC$y[dataNC$y == "q_popdensity"] <- "Population Density"
dataNC$y[dataNC$y == "older_pecent"] <- "% of Population Age 65+"
dataNC$y[dataNC$y == "young_pecent"] <- "% of Population Ages 0-14"
dataNC$y[dataNC$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataNC$y[dataNC$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataNC$y[dataNC$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataNC$y[dataNC$y == "pct_obesity"] <- "% of Adults with Obesity"
dataNC$y[dataNC$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataNC$y[dataNC$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataNC$y[dataNC$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataNC$y[dataNC$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataNC$y[dataNC$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataNC$y[dataNC$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataNC$y[dataNC$y == "infant_deaths"] <- "Number of Infant Deaths"
dataNC$y[dataNC$y == "pct_diabetes"] <- "% of County with Diabetes"
dataNC$y[dataNC$y == "# Food Insecure"] <- "# Food Insecurity"
dataNC$y[dataNC$y == "% Food Insecure"] <- "% Food Insecurity"
dataNC$y[dataNC$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataNC$y[dataNC$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataNC$y[dataNC$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataNC$y[dataNC$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataNC$y[dataNC$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataNC$y[dataNC$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataNC$y[dataNC$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataNC$y[dataNC$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataNC$y[dataNC$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataNC$y[dataNC$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataNC$y[dataNC$y == "Denominator"] <- "Estimated Number of Juveniles"
dataNC$y[dataNC$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataNC$y[dataNC$y == "pct_age65"] <- "% of Adults Age 65+"
dataNC$y[dataNC$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataNC$y[dataNC$y == "Assault.death_rate"] <- "Assault Death Rate"
dataNC$y[dataNC$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataNC$y[dataNC$y == "Despair.death_rate"] <- "Despair Death Rate"
dataNC$y[dataNC$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataNC$y[dataNC$y == "COPD"] <- "% of County with COPD"
dataNC$y[dataNC$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataNC$y[dataNC$y == "LungCancer"] <- "% of County with Lung Cancer"

dataNC$y <- factor(dataNC$y, levels = dataNC$y[order(dataNC$x)])

p<-ggplot(dataNC, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=6, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.1)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("NC_desprt.png")
```


North Dakota
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "ND"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataND <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataND <- dataND %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataND$y <- factor(dataND$y, levels = dataND$y)

#plot
x <- dataND$x
x_num<-round(x,digits=2)
dataND$x_round = x_num

dataND$y <- as.character(dataND$y)
dataND$y[dataND$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataND$y[dataND$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataND$y[dataND$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataND$y[dataND$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataND$y[dataND$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataND$y[dataND$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataND$y[dataND$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataND$y[dataND$y == "% Uninsured"] <- "% of County Uninsured"
dataND$y[dataND$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataND$y[dataND$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataND$y[dataND$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataND$y[dataND$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataND$y[dataND$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataND$y[dataND$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataND$y[dataND$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataND$y[dataND$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataND$y[dataND$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataND$y[dataND$y == "Active"] <- "Number of Active COVID-19 Cases"
dataND$y[dataND$y == "Lat"] <- "Latitude"
dataND$y[dataND$y == "Long_"] <- "Longitude"
dataND$y[dataND$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataND$y[dataND$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataND$y[dataND$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataND$y[dataND$y == "poverty"] <- "% Living in Poverty"
dataND$y[dataND$y == "popdensity"] <- "Population Density"
dataND$y[dataND$y == "medianhousevalue"] <- "Median House Value"
dataND$y[dataND$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataND$y[dataND$y == "education"] <- "% with less than High-School Education"
dataND$y[dataND$y == "population"] <- "Overall Population"
dataND$y[dataND$y == "pct_blk"] <- "% African American in County"
dataND$y[dataND$y == "hispanic"] <- "% Hispanic in County"
dataND$y[dataND$y == "pct_asian"] <- "% Asian in County"
dataND$y[dataND$y == "pct_native"] <- "% Native American in County"
dataND$y[dataND$y == "pct_white"] <- "% White in County"
dataND$y[dataND$y == "q_popdensity"] <- "Population Density"
dataND$y[dataND$y == "older_pecent"] <- "% of Population Age 65+"
dataND$y[dataND$y == "young_pecent"] <- "% of Population Ages 0-14"
dataND$y[dataND$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataND$y[dataND$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataND$y[dataND$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataND$y[dataND$y == "pct_obesity"] <- "% of Adults with Obesity"
dataND$y[dataND$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataND$y[dataND$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataND$y[dataND$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataND$y[dataND$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataND$y[dataND$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataND$y[dataND$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataND$y[dataND$y == "infant_deaths"] <- "Number of Infant Deaths"
dataND$y[dataND$y == "pct_diabetes"] <- "% of County with Diabetes"
dataND$y[dataND$y == "# Food Insecure"] <- "# Food Insecurity"
dataND$y[dataND$y == "% Food Insecure"] <- "% Food Insecurity"
dataND$y[dataND$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataND$y[dataND$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataND$y[dataND$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataND$y[dataND$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataND$y[dataND$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataND$y[dataND$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataND$y[dataND$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataND$y[dataND$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataND$y[dataND$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataND$y[dataND$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataND$y[dataND$y == "Denominator"] <- "Estimated Number of Juveniles"
dataND$y[dataND$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataND$y[dataND$y == "pct_age65"] <- "% of Adults Age 65+"
dataND$y[dataND$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataND$y[dataND$y == "Assault.death_rate"] <- "Assault Death Rate"
dataND$y[dataND$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataND$y[dataND$y == "Despair.death_rate"] <- "Despair Death Rate"
dataND$y[dataND$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataND$y[dataND$y == "COPD"] <- "% of County with COPD"
dataND$y[dataND$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataND$y[dataND$y == "LungCancer"] <- "% of County with Lung Cancer"

dataND$y <- factor(dataND$y, levels = dataND$y[order(dataND$x)])

p<-ggplot(dataND, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.9)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("ND_desprt.png")
```

Ohio
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "OH"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataOH <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataOH <- dataOH %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataOH$y <- factor(dataOH$y, levels = dataOH$y)

#plot
x <- dataOH$x
x_num<-round(x,digits=2)
dataOH$x_round = x_num

dataOH$y <- as.character(dataOH$y)
dataOH$y[dataOH$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataOH$y[dataOH$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataOH$y[dataOH$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataOH$y[dataOH$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataOH$y[dataOH$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataOH$y[dataOH$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataOH$y[dataOH$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataOH$y[dataOH$y == "% Uninsured"] <- "% of County Uninsured"
dataOH$y[dataOH$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataOH$y[dataOH$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataOH$y[dataOH$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataOH$y[dataOH$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataOH$y[dataOH$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataOH$y[dataOH$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataOH$y[dataOH$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataOH$y[dataOH$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataOH$y[dataOH$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataOH$y[dataOH$y == "Active"] <- "Number of Active COVID-19 Cases"
dataOH$y[dataOH$y == "Lat"] <- "Latitude"
dataOH$y[dataOH$y == "Long_"] <- "Longitude"
dataOH$y[dataOH$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataOH$y[dataOH$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataOH$y[dataOH$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataOH$y[dataOH$y == "poverty"] <- "% Living in Poverty"
dataOH$y[dataOH$y == "popdensity"] <- "Population Density"
dataOH$y[dataOH$y == "medianhousevalue"] <- "Median House Value"
dataOH$y[dataOH$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataOH$y[dataOH$y == "education"] <- "% with less than High-School Education"
dataOH$y[dataOH$y == "population"] <- "Overall Population"
dataOH$y[dataOH$y == "pct_blk"] <- "% African American in County"
dataOH$y[dataOH$y == "hispanic"] <- "% Hispanic in County"
dataOH$y[dataOH$y == "pct_asian"] <- "% Asian in County"
dataOH$y[dataOH$y == "pct_native"] <- "% Native American in County"
dataOH$y[dataOH$y == "pct_white"] <- "% White in County"
dataOH$y[dataOH$y == "q_popdensity"] <- "Population Density"
dataOH$y[dataOH$y == "older_pecent"] <- "% of Population Age 65+"
dataOH$y[dataOH$y == "young_pecent"] <- "% of Population Ages 0-14"
dataOH$y[dataOH$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataOH$y[dataOH$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataOH$y[dataOH$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataOH$y[dataOH$y == "pct_obesity"] <- "% of Adults with Obesity"
dataOH$y[dataOH$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataOH$y[dataOH$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataOH$y[dataOH$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataOH$y[dataOH$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataOH$y[dataOH$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataOH$y[dataOH$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataOH$y[dataOH$y == "infant_deaths"] <- "Number of Infant Deaths"
dataOH$y[dataOH$y == "pct_diabetes"] <- "% of County with Diabetes"
dataOH$y[dataOH$y == "# Food Insecure"] <- "# Food Insecurity"
dataOH$y[dataOH$y == "% Food Insecure"] <- "% Food Insecurity"
dataOH$y[dataOH$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataOH$y[dataOH$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataOH$y[dataOH$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataOH$y[dataOH$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataOH$y[dataOH$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataOH$y[dataOH$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataOH$y[dataOH$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataOH$y[dataOH$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataOH$y[dataOH$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataOH$y[dataOH$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataOH$y[dataOH$y == "Denominator"] <- "Estimated Number of Juveniles"
dataOH$y[dataOH$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataOH$y[dataOH$y == "pct_age65"] <- "% of Adults Age 65+"
dataOH$y[dataOH$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataOH$y[dataOH$y == "Assault.death_rate"] <- "Assault Death Rate"
dataOH$y[dataOH$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataOH$y[dataOH$y == "Despair.death_rate"] <- "Despair Death Rate"
dataOH$y[dataOH$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataOH$y[dataOH$y == "COPD"] <- "% of County with COPD"
dataOH$y[dataOH$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataOH$y[dataOH$y == "LungCancer"] <- "% of County with Lung Cancer"

dataOH$y <- factor(dataOH$y, levels = dataOH$y[order(dataOH$x)])

p<-ggplot(dataOH, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=7, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .15)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.15)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("OH_desprt.png")
```

Oklahoma
```{r}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "OK"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataOK <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataOK <- dataOK %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataOK$y <- factor(dataOK$y, levels = dataOK$y)

#plot
x <- dataOK$x
x_num<-round(x,digits=2)
dataOK$x_round = x_num

dataOK$y <- as.character(dataOK$y)
dataOK$y[dataOK$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataOK$y[dataOK$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataOK$y[dataOK$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataOK$y[dataOK$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataOK$y[dataOK$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataOK$y[dataOK$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataOK$y[dataOK$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataOK$y[dataOK$y == "% Uninsured"] <- "% of County Uninsured"
dataOK$y[dataOK$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataOK$y[dataOK$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataOK$y[dataOK$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataOK$y[dataOK$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataOK$y[dataOK$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataOK$y[dataOK$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataOK$y[dataOK$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataOK$y[dataOK$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataOK$y[dataOK$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataOK$y[dataOK$y == "Active"] <- "Number of Active COVID-19 Cases"
dataOK$y[dataOK$y == "Lat"] <- "Latitude"
dataOK$y[dataOK$y == "Long_"] <- "Longitude"
dataOK$y[dataOK$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataOK$y[dataOK$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataOK$y[dataOK$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataOK$y[dataOK$y == "poverty"] <- "% Living in Poverty"
dataOK$y[dataOK$y == "popdensity"] <- "Population Density"
dataOK$y[dataOK$y == "medianhousevalue"] <- "Median House Value"
dataOK$y[dataOK$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataOK$y[dataOK$y == "education"] <- "% with less than High-School Education"
dataOK$y[dataOK$y == "population"] <- "Overall Population"
dataOK$y[dataOK$y == "pct_blk"] <- "% African American in County"
dataOK$y[dataOK$y == "hispanic"] <- "% Hispanic in County"
dataOK$y[dataOK$y == "pct_asian"] <- "% Asian in County"
dataOK$y[dataOK$y == "pct_native"] <- "% Native American in County"
dataOK$y[dataOK$y == "pct_white"] <- "% White in County"
dataOK$y[dataOK$y == "q_popdensity"] <- "Population Density"
dataOK$y[dataOK$y == "older_pecent"] <- "% of Population Age 65+"
dataOK$y[dataOK$y == "young_pecent"] <- "% of Population Ages 0-14"
dataOK$y[dataOK$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataOK$y[dataOK$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataOK$y[dataOK$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataOK$y[dataOK$y == "pct_obesity"] <- "% of Adults with Obesity"
dataOK$y[dataOK$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataOK$y[dataOK$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataOK$y[dataOK$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataOK$y[dataOK$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataOK$y[dataOK$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataOK$y[dataOK$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataOK$y[dataOK$y == "infant_deaths"] <- "Number of Infant Deaths"
dataOK$y[dataOK$y == "pct_diabetes"] <- "% of County with Diabetes"
dataOK$y[dataOK$y == "# Food Insecure"] <- "# Food Insecurity"
dataOK$y[dataOK$y == "% Food Insecure"] <- "% Food Insecurity"
dataOK$y[dataOK$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataOK$y[dataOK$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataOK$y[dataOK$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataOK$y[dataOK$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataOK$y[dataOK$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataOK$y[dataOK$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataOK$y[dataOK$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataOK$y[dataOK$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataOK$y[dataOK$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataOK$y[dataOK$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataOK$y[dataOK$y == "Denominator"] <- "Estimated Number of Juveniles"
dataOK$y[dataOK$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataOK$y[dataOK$y == "pct_age65"] <- "% of Adults Age 65+"
dataOK$y[dataOK$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataOK$y[dataOK$y == "Assault.death_rate"] <- "Assault Death Rate"
dataOK$y[dataOK$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataOK$y[dataOK$y == "Despair.death_rate"] <- "Despair Death Rate"
dataOK$y[dataOK$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataOK$y[dataOK$y == "COPD"] <- "% of County with COPD"
dataOK$y[dataOK$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataOK$y[dataOK$y == "LungCancer"] <- "% of County with Lung Cancer"

dataOK$y <- factor(dataOK$y, levels = dataOK$y[order(dataOK$x)])

p<-ggplot(dataOK, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .2)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.2) +
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("OK_desprt.png")

```

Oregan 
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "OR"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataOR <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataOR <- dataOR %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataOR$y <- factor(dataOR$y, levels = dataOR$y)

#plot
x <- dataOR$x
x_num<-round(x,digits=2)
dataOR$x_round = x_num

dataOR$y <- as.character(dataOR$y)
dataOR$y[dataOR$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataOR$y[dataOR$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataOR$y[dataOR$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataOR$y[dataOR$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataOR$y[dataOR$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataOR$y[dataOR$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataOR$y[dataOR$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataOR$y[dataOR$y == "% Uninsured"] <- "% of County Uninsured"
dataOR$y[dataOR$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataOR$y[dataOR$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataOR$y[dataOR$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataOR$y[dataOR$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataOR$y[dataOR$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataOR$y[dataOR$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataOR$y[dataOR$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataOR$y[dataOR$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataOR$y[dataOR$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataOR$y[dataOR$y == "Active"] <- "Number of Active COVID-19 Cases"
dataOR$y[dataOR$y == "Lat"] <- "Latitude"
dataOR$y[dataOR$y == "Long_"] <- "Longitude"
dataOR$y[dataOR$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataOR$y[dataOR$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataOR$y[dataOR$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataOR$y[dataOR$y == "poverty"] <- "% Living in Poverty"
dataOR$y[dataOR$y == "popdensity"] <- "Population Density"
dataOR$y[dataOR$y == "medianhousevalue"] <- "Median House Value"
dataOR$y[dataOR$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataOR$y[dataOR$y == "education"] <- "% with less than High-School Education"
dataOR$y[dataOR$y == "population"] <- "Overall Population"
dataOR$y[dataOR$y == "pct_blk"] <- "% African American in County"
dataOR$y[dataOR$y == "hispanic"] <- "% Hispanic in County"
dataOR$y[dataOR$y == "pct_asian"] <- "% Asian in County"
dataOR$y[dataOR$y == "pct_native"] <- "% Native American in County"
dataOR$y[dataOR$y == "pct_white"] <- "% White in County"
dataOR$y[dataOR$y == "q_popdensity"] <- "Population Density"
dataOR$y[dataOR$y == "older_pecent"] <- "% of Population Age 65+"
dataOR$y[dataOR$y == "young_pecent"] <- "% of Population Ages 0-14"
dataOR$y[dataOR$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataOR$y[dataOR$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataOR$y[dataOR$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataOR$y[dataOR$y == "pct_obesity"] <- "% of Adults with Obesity"
dataOR$y[dataOR$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataOR$y[dataOR$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataOR$y[dataOR$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataOR$y[dataOR$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataOR$y[dataOR$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataOR$y[dataOR$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataOR$y[dataOR$y == "infant_deaths"] <- "Number of Infant Deaths"
dataOR$y[dataOR$y == "pct_diabetes"] <- "% of County with Diabetes"
dataOR$y[dataOR$y == "# Food Insecure"] <- "# Food Insecurity"
dataOR$y[dataOR$y == "% Food Insecure"] <- "% Food Insecurity"
dataOR$y[dataOR$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataOR$y[dataOR$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataOR$y[dataOR$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataOR$y[dataOR$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataOR$y[dataOR$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataOR$y[dataOR$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataOR$y[dataOR$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataOR$y[dataOR$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataOR$y[dataOR$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataOR$y[dataOR$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataOR$y[dataOR$y == "Denominator"] <- "Estimated Number of Juveniles"
dataOR$y[dataOR$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataOR$y[dataOR$y == "pct_age65"] <- "% of Adults Age 65+"
dataOR$y[dataOR$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataOR$y[dataOR$y == "Assault.death_rate"] <- "Assault Death Rate"
dataOR$y[dataOR$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataOR$y[dataOR$y == "Despair.death_rate"] <- "Despair Death Rate"
dataOR$y[dataOR$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataOR$y[dataOR$y == "COPD"] <- "% of County with COPD"
dataOR$y[dataOR$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataOR$y[dataOR$y == "LungCancer"] <- "% of County with Lung Cancer"

dataOR$y <- factor(dataOR$y, levels = dataOR$y[order(dataOR$x)])

p<-ggplot(dataOR, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("OR_desprt.png")
```

Pennsylvania
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "PA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataPA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataPA <- dataPA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataPA$y <- factor(dataPA$y, levels = dataPA$y)

#plot
x <- dataPA$x
x_num<-round(x,digits=2)
dataPA$x_round = x_num

dataPA$y <- as.character(dataPA$y)
dataPA$y[dataPA$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataPA$y[dataPA$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataPA$y[dataPA$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataPA$y[dataPA$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataPA$y[dataPA$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataPA$y[dataPA$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataPA$y[dataPA$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataPA$y[dataPA$y == "% Uninsured"] <- "% of County Uninsured"
dataPA$y[dataPA$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataPA$y[dataPA$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataPA$y[dataPA$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataPA$y[dataPA$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataPA$y[dataPA$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataPA$y[dataPA$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataPA$y[dataPA$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataPA$y[dataPA$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataPA$y[dataPA$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataPA$y[dataPA$y == "Active"] <- "Number of Active COVID-19 Cases"
dataPA$y[dataPA$y == "Lat"] <- "Latitude"
dataPA$y[dataPA$y == "Long_"] <- "Longitude"
dataPA$y[dataPA$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataPA$y[dataPA$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataPA$y[dataPA$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataPA$y[dataPA$y == "poverty"] <- "% Living in Poverty"
dataPA$y[dataPA$y == "popdensity"] <- "Population Density"
dataPA$y[dataPA$y == "medianhousevalue"] <- "Median House Value"
dataPA$y[dataPA$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataPA$y[dataPA$y == "education"] <- "% with less than High-School Education"
dataPA$y[dataPA$y == "population"] <- "Overall Population"
dataPA$y[dataPA$y == "pct_blk"] <- "% African American in County"
dataPA$y[dataPA$y == "hispanic"] <- "% Hispanic in County"
dataPA$y[dataPA$y == "pct_asian"] <- "% Asian in County"
dataPA$y[dataPA$y == "pct_native"] <- "% Native American in County"
dataPA$y[dataPA$y == "pct_white"] <- "% White in County"
dataPA$y[dataPA$y == "q_popdensity"] <- "Population Density"
dataPA$y[dataPA$y == "older_pecent"] <- "% of Population Age 65+"
dataPA$y[dataPA$y == "young_pecent"] <- "% of Population Ages 0-14"
dataPA$y[dataPA$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataPA$y[dataPA$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataPA$y[dataPA$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataPA$y[dataPA$y == "pct_obesity"] <- "% of Adults with Obesity"
dataPA$y[dataPA$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataPA$y[dataPA$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataPA$y[dataPA$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataPA$y[dataPA$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataPA$y[dataPA$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataPA$y[dataPA$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataPA$y[dataPA$y == "infant_deaths"] <- "Number of Infant Deaths"
dataPA$y[dataPA$y == "pct_diabetes"] <- "% of County with Diabetes"
dataPA$y[dataPA$y == "# Food Insecure"] <- "# Food Insecurity"
dataPA$y[dataPA$y == "% Food Insecure"] <- "% Food Insecurity"
dataPA$y[dataPA$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataPA$y[dataPA$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataPA$y[dataPA$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataPA$y[dataPA$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataPA$y[dataPA$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataPA$y[dataPA$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataPA$y[dataPA$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataPA$y[dataPA$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataPA$y[dataPA$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataPA$y[dataPA$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataPA$y[dataPA$y == "Denominator"] <- "Estimated Number of Juveniles"
dataPA$y[dataPA$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataPA$y[dataPA$y == "pct_age65"] <- "% of Adults Age 65+"
dataPA$y[dataPA$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataPA$y[dataPA$y == "Assault.death_rate"] <- "Assault Death Rate"
dataPA$y[dataPA$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataPA$y[dataPA$y == "Despair.death_rate"] <- "Despair Death Rate"
dataPA$y[dataPA$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataPA$y[dataPA$y == "COPD"] <- "% of County with COPD"
dataPA$y[dataPA$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataPA$y[dataPA$y == "LungCancer"] <- "% of County with Lung Cancer"
dataPA$y[dataPA$y == "pct_owner_occ"] <- "% Owner-Occupied Housing"

dataPA$y <- factor(dataPA$y, levels = dataPA$y[order(dataPA$x)])

p<- ggplot(dataPA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_round), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .15)+
  geom_text(aes(label=x_round), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.15)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("PA_desprt.png")
```

Rhode Island (not enough)
```{r}
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))
ggsave("RI_desprt.png")
```

South Carolina
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "SC"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataSC <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataSC <- dataSC %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataSC$y <- factor(dataSC$y, levels = dataSC$y)

#plot
x <- dataSC$x
x_num<-round(x,digits=2)
dataSC$x_round = x_num

dataSC$y <- as.character(dataSC$y)
dataSC$y[dataSC$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataSC$y[dataSC$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataSC$y[dataSC$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataSC$y[dataSC$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataSC$y[dataSC$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataSC$y[dataSC$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataSC$y[dataSC$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataSC$y[dataSC$y == "% Uninsured"] <- "% of County Uninsured"
dataSC$y[dataSC$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataSC$y[dataSC$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataSC$y[dataSC$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataSC$y[dataSC$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataSC$y[dataSC$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataSC$y[dataSC$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataSC$y[dataSC$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataSC$y[dataSC$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataSC$y[dataSC$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataSC$y[dataSC$y == "Active"] <- "Number of Active COVID-19 Cases"
dataSC$y[dataSC$y == "Lat"] <- "Latitude"
dataSC$y[dataSC$y == "Long_"] <- "Longitude"
dataSC$y[dataSC$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataSC$y[dataSC$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataSC$y[dataSC$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataSC$y[dataSC$y == "poverty"] <- "% Living in Poverty"
dataSC$y[dataSC$y == "popdensity"] <- "Population Density"
dataSC$y[dataSC$y == "medianhousevalue"] <- "Median House Value"
dataSC$y[dataSC$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataSC$y[dataSC$y == "education"] <- "% with less than High-School Education"
dataSC$y[dataSC$y == "population"] <- "Overall Population"
dataSC$y[dataSC$y == "pct_blk"] <- "% African American in County"
dataSC$y[dataSC$y == "hispanic"] <- "% Hispanic in County"
dataSC$y[dataSC$y == "pct_asian"] <- "% Asian in County"
dataSC$y[dataSC$y == "pct_native"] <- "% Native American in County"
dataSC$y[dataSC$y == "pct_white"] <- "% White in County"
dataSC$y[dataSC$y == "q_popdensity"] <- "Population Density"
dataSC$y[dataSC$y == "older_pecent"] <- "% of Population Age 65+"
dataSC$y[dataSC$y == "young_pecent"] <- "% of Population Ages 0-14"
dataSC$y[dataSC$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataSC$y[dataSC$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataSC$y[dataSC$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataSC$y[dataSC$y == "pct_obesity"] <- "% of Adults with Obesity"
dataSC$y[dataSC$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataSC$y[dataSC$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataSC$y[dataSC$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataSC$y[dataSC$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataSC$y[dataSC$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataSC$y[dataSC$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataSC$y[dataSC$y == "infant_deaths"] <- "Number of Infant Deaths"
dataSC$y[dataSC$y == "pct_diabetes"] <- "% of County with Diabetes"
dataSC$y[dataSC$y == "# Food Insecure"] <- "# Food Insecurity"
dataSC$y[dataSC$y == "% Food Insecure"] <- "% Food Insecurity"
dataSC$y[dataSC$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataSC$y[dataSC$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataSC$y[dataSC$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataSC$y[dataSC$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataSC$y[dataSC$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataSC$y[dataSC$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataSC$y[dataSC$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataSC$y[dataSC$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataSC$y[dataSC$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataSC$y[dataSC$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataSC$y[dataSC$y == "Denominator"] <- "Estimated Number of Juveniles"
dataSC$y[dataSC$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataSC$y[dataSC$y == "pct_age65"] <- "% of Adults Age 65+"
dataSC$y[dataSC$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataSC$y[dataSC$y == "Assault.death_rate"] <- "Assault Death Rate"
dataSC$y[dataSC$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataSC$y[dataSC$y == "Despair.death_rate"] <- "Despair Death Rate"
dataSC$y[dataSC$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataSC$y[dataSC$y == "COPD"] <- "% of County with COPD"
dataSC$y[dataSC$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataSC$y[dataSC$y == "LungCancer"] <- "% of County with Lung Cancer"

dataSC$y <- factor(dataSC$y, levels = dataSC$y[order(dataSC$x)])

p<-ggplot(dataSC, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.05)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("SC_desprt.png")
```

South Dakota
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "SD"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataSD <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataSD <- dataSD %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataSD$y <- factor(dataSD$y, levels = dataSD$y)

#plot
x <- dataSD$x
x_num<-round(x,digits=2)
dataSD$x_round = x_num

dataSD$y <- as.character(dataSD$y)
dataSD$y[dataSD$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataSD$y[dataSD$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataSD$y[dataSD$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataSD$y[dataSD$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataSD$y[dataSD$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataSD$y[dataSD$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataSD$y[dataSD$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataSD$y[dataSD$y == "% Uninsured"] <- "% of County Uninsured"
dataSD$y[dataSD$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataSD$y[dataSD$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataSD$y[dataSD$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataSD$y[dataSD$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataSD$y[dataSD$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataSD$y[dataSD$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataSD$y[dataSD$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataSD$y[dataSD$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataSD$y[dataSD$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataSD$y[dataSD$y == "Active"] <- "Number of Active COVID-19 Cases"
dataSD$y[dataSD$y == "Lat"] <- "Latitude"
dataSD$y[dataSD$y == "Long_"] <- "Longitude"
dataSD$y[dataSD$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataSD$y[dataSD$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataSD$y[dataSD$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataSD$y[dataSD$y == "poverty"] <- "% Living in Poverty"
dataSD$y[dataSD$y == "popdensity"] <- "Population Density"
dataSD$y[dataSD$y == "medianhousevalue"] <- "Median House Value"
dataSD$y[dataSD$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataSD$y[dataSD$y == "education"] <- "% with less than High-School Education"
dataSD$y[dataSD$y == "population"] <- "Overall Population"
dataSD$y[dataSD$y == "pct_blk"] <- "% African American in County"
dataSD$y[dataSD$y == "hispanic"] <- "% Hispanic in County"
dataSD$y[dataSD$y == "pct_asian"] <- "% Asian in County"
dataSD$y[dataSD$y == "pct_native"] <- "% Native American in County"
dataSD$y[dataSD$y == "pct_white"] <- "% White in County"
dataSD$y[dataSD$y == "q_popdensity"] <- "Population Density"
dataSD$y[dataSD$y == "older_pecent"] <- "% of Population Age 65+"
dataSD$y[dataSD$y == "young_pecent"] <- "% of Population Ages 0-14"
dataSD$y[dataSD$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataSD$y[dataSD$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataSD$y[dataSD$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataSD$y[dataSD$y == "pct_obesity"] <- "% of Adults with Obesity"
dataSD$y[dataSD$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataSD$y[dataSD$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataSD$y[dataSD$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataSD$y[dataSD$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataSD$y[dataSD$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataSD$y[dataSD$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataSD$y[dataSD$y == "infant_deaths"] <- "Number of Infant Deaths"
dataSD$y[dataSD$y == "pct_diabetes"] <- "% of County with Diabetes"
dataSD$y[dataSD$y == "# Food Insecure"] <- "# Food Insecurity"
dataSD$y[dataSD$y == "% Food Insecure"] <- "% Food Insecurity"
dataSD$y[dataSD$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataSD$y[dataSD$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataSD$y[dataSD$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataSD$y[dataSD$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataSD$y[dataSD$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataSD$y[dataSD$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataSD$y[dataSD$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataSD$y[dataSD$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataSD$y[dataSD$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataSD$y[dataSD$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataSD$y[dataSD$y == "Denominator"] <- "Estimated Number of Juveniles"
dataSD$y[dataSD$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataSD$y[dataSD$y == "pct_age65"] <- "% of Adults Age 65+"
dataSD$y[dataSD$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataSD$y[dataSD$y == "Assault.death_rate"] <- "Assault Death Rate"
dataSD$y[dataSD$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataSD$y[dataSD$y == "Despair.death_rate"] <- "Despair Death Rate"
dataSD$y[dataSD$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataSD$y[dataSD$y == "COPD"] <- "% of County with COPD"
dataSD$y[dataSD$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataSD$y[dataSD$y == "LungCancer"] <- "% of County with Lung Cancer"

dataSD$y <- factor(dataSD$y, levels = dataSD$y[order(dataSD$x)])

p<-ggplot(dataSD, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=4, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_round), vjust=0.5,color="black", size=3.5, nudge_x = 5)+geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)

}
p
ggsave("SD_desprt.png")
```

Tennessee
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "TN"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataTN <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataTN <- dataTN %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataTN$y <- factor(dataTN$y, levels = dataTN$y)

#plot
x <- dataTN$x
x_num<-round(x,digits=2)
dataTN$x_round = x_num

dataTN$y <- as.character(dataTN$y)
dataTN$y[dataTN$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataTN$y[dataTN$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataTN$y[dataTN$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataTN$y[dataTN$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataTN$y[dataTN$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataTN$y[dataTN$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataTN$y[dataTN$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataTN$y[dataTN$y == "% Uninsured"] <- "% of County Uninsured"
dataTN$y[dataTN$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataTN$y[dataTN$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataTN$y[dataTN$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataTN$y[dataTN$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataTN$y[dataTN$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataTN$y[dataTN$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataTN$y[dataTN$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataTN$y[dataTN$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataTN$y[dataTN$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataTN$y[dataTN$y == "Active"] <- "Number of Active COVID-19 Cases"
dataTN$y[dataTN$y == "Lat"] <- "Latitude"
dataTN$y[dataTN$y == "Long_"] <- "Longitude"
dataTN$y[dataTN$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataTN$y[dataTN$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataTN$y[dataTN$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataTN$y[dataTN$y == "poverty"] <- "% Living in Poverty"
dataTN$y[dataTN$y == "popdensity"] <- "Population Density"
dataTN$y[dataTN$y == "medianhousevalue"] <- "Median House Value"
dataTN$y[dataTN$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataTN$y[dataTN$y == "education"] <- "% with less than High-School Education"
dataTN$y[dataTN$y == "population"] <- "Overall Population"
dataTN$y[dataTN$y == "pct_blk"] <- "% African American in County"
dataTN$y[dataTN$y == "hispanic"] <- "% Hispanic in County"
dataTN$y[dataTN$y == "pct_asian"] <- "% Asian in County"
dataTN$y[dataTN$y == "pct_native"] <- "% Native American in County"
dataTN$y[dataTN$y == "pct_white"] <- "% White in County"
dataTN$y[dataTN$y == "q_popdensity"] <- "Population Density"
dataTN$y[dataTN$y == "older_pecent"] <- "% of Population Age 65+"
dataTN$y[dataTN$y == "young_pecent"] <- "% of Population Ages 0-14"
dataTN$y[dataTN$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataTN$y[dataTN$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataTN$y[dataTN$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataTN$y[dataTN$y == "pct_obesity"] <- "% of Adults with Obesity"
dataTN$y[dataTN$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataTN$y[dataTN$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataTN$y[dataTN$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataTN$y[dataTN$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataTN$y[dataTN$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataTN$y[dataTN$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataTN$y[dataTN$y == "infant_deaths"] <- "Number of Infant Deaths"
dataTN$y[dataTN$y == "pct_diabetes"] <- "% of County with Diabetes"
dataTN$y[dataTN$y == "# Food Insecure"] <- "# Food Insecurity"
dataTN$y[dataTN$y == "% Food Insecure"] <- "% Food Insecurity"
dataTN$y[dataTN$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataTN$y[dataTN$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataTN$y[dataTN$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataTN$y[dataTN$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataTN$y[dataTN$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataTN$y[dataTN$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataTN$y[dataTN$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataTN$y[dataTN$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataTN$y[dataTN$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataTN$y[dataTN$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataTN$y[dataTN$y == "Denominator"] <- "Estimated Number of Juveniles"
dataTN$y[dataTN$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataTN$y[dataTN$y == "pct_age65"] <- "% of Adults Age 65+"
dataTN$y[dataTN$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataTN$y[dataTN$y == "Assault.death_rate"] <- "Assault Death Rate"
dataTN$y[dataTN$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataTN$y[dataTN$y == "Despair.death_rate"] <- "Despair Death Rate"
dataTN$y[dataTN$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataTN$y[dataTN$y == "COPD"] <- "% of County with COPD"
dataTN$y[dataTN$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataTN$y[dataTN$y == "LungCancer"] <- "% of County with Lung Cancer"

dataTN$y <- factor(dataTN$y, levels = dataTN$y[order(dataTN$x)])

p<-ggplot(dataTN, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.11)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("TN_desprt.png")
```

Texas
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "TX"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataTX <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataTX <- dataTX %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataTX$y <- factor(dataTX$y, levels = dataTX$y)

#plot
x <- dataTX$x
x_num<-round(x,digits=2)
dataTX$x_round = x_num

dataTX$y <- as.character(dataTX$y)
dataTX$y[dataTX$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataTX$y[dataTX$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataTX$y[dataTX$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataTX$y[dataTX$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataTX$y[dataTX$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataTX$y[dataTX$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataTX$y[dataTX$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataTX$y[dataTX$y == "% Uninsured"] <- "% of County Uninsured"
dataTX$y[dataTX$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataTX$y[dataTX$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataTX$y[dataTX$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataTX$y[dataTX$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataTX$y[dataTX$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataTX$y[dataTX$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataTX$y[dataTX$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataTX$y[dataTX$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataTX$y[dataTX$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataTX$y[dataTX$y == "Active"] <- "Number of Active COVID-19 Cases"
dataTX$y[dataTX$y == "Lat"] <- "Latitude"
dataTX$y[dataTX$y == "Long_"] <- "Longitude"
dataTX$y[dataTX$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataTX$y[dataTX$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataTX$y[dataTX$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataTX$y[dataTX$y == "poverty"] <- "% Living in Poverty"
dataTX$y[dataTX$y == "popdensity"] <- "Population Density"
dataTX$y[dataTX$y == "medianhousevalue"] <- "Median House Value"
dataTX$y[dataTX$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataTX$y[dataTX$y == "education"] <- "% with less than High-School Education"
dataTX$y[dataTX$y == "population"] <- "Overall Population"
dataTX$y[dataTX$y == "pct_blk"] <- "% African American in County"
dataTX$y[dataTX$y == "hispanic"] <- "% Hispanic in County"
dataTX$y[dataTX$y == "pct_asian"] <- "% Asian in County"
dataTX$y[dataTX$y == "pct_native"] <- "% Native American in County"
dataTX$y[dataTX$y == "pct_white"] <- "% White in County"
dataTX$y[dataTX$y == "q_popdensity"] <- "Population Density"
dataTX$y[dataTX$y == "older_pecent"] <- "% of Population Age 65+"
dataTX$y[dataTX$y == "young_pecent"] <- "% of Population Ages 0-14"
dataTX$y[dataTX$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataTX$y[dataTX$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataTX$y[dataTX$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataTX$y[dataTX$y == "pct_obesity"] <- "% of Adults with Obesity"
dataTX$y[dataTX$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataTX$y[dataTX$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataTX$y[dataTX$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataTX$y[dataTX$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataTX$y[dataTX$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataTX$y[dataTX$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataTX$y[dataTX$y == "infant_deaths"] <- "Number of Infant Deaths"
dataTX$y[dataTX$y == "pct_diabetes"] <- "% of County with Diabetes"
dataTX$y[dataTX$y == "# Food Insecure"] <- "# Food Insecurity"
dataTX$y[dataTX$y == "% Food Insecure"] <- "% Food Insecurity"
dataTX$y[dataTX$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataTX$y[dataTX$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataTX$y[dataTX$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataTX$y[dataTX$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataTX$y[dataTX$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataTX$y[dataTX$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataTX$y[dataTX$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataTX$y[dataTX$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataTX$y[dataTX$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataTX$y[dataTX$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataTX$y[dataTX$y == "Denominator"] <- "Estimated Number of Juveniles"
dataTX$y[dataTX$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataTX$y[dataTX$y == "pct_age65"] <- "% of Adults Age 65+"
dataTX$y[dataTX$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataTX$y[dataTX$y == "Assault.death_rate"] <- "Assault Death Rate"
dataTX$y[dataTX$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataTX$y[dataTX$y == "Despair.death_rate"] <- "Despair Death Rate"
dataTX$y[dataTX$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataTX$y[dataTX$y == "COPD"] <- "% of County with COPD"
dataTX$y[dataTX$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataTX$y[dataTX$y == "LungCancer"] <- "% of County with Lung Cancer"

dataTX$y <- factor(dataTX$y, levels = dataTX$y[order(dataTX$x)])

p<-ggplot(dataTX, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=7, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = .1)+
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("TX_desprt.png")
```

Utah (not enough)
```{r}
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))
ggsave("UT_desprt.png")
```

Vermont(not enough)
```{r}
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))
ggsave("VT_desprt.png")
```

Virginia
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "VA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataVA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataVA <- dataVA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataVA$y <- factor(dataVA$y, levels = dataVA$y)

#plot
x <- dataVA$x
x_num<-round(x,digits=2)
dataVA$x_round = x_num

dataVA$y <- as.character(dataVA$y)
dataVA$y[dataVA$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataVA$y[dataVA$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataVA$y[dataVA$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataVA$y[dataVA$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataVA$y[dataVA$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataVA$y[dataVA$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataVA$y[dataVA$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataVA$y[dataVA$y == "% Uninsured"] <- "% of County Uninsured"
dataVA$y[dataVA$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataVA$y[dataVA$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataVA$y[dataVA$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataVA$y[dataVA$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataVA$y[dataVA$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataVA$y[dataVA$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataVA$y[dataVA$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataVA$y[dataVA$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataVA$y[dataVA$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataVA$y[dataVA$y == "Active"] <- "Number of Active COVID-19 Cases"
dataVA$y[dataVA$y == "Lat"] <- "Latitude"
dataVA$y[dataVA$y == "Long_"] <- "Longitude"
dataVA$y[dataVA$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataVA$y[dataVA$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataVA$y[dataVA$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataVA$y[dataVA$y == "poverty"] <- "% Living in Poverty"
dataVA$y[dataVA$y == "popdensity"] <- "Population Density"
dataVA$y[dataVA$y == "medianhousevalue"] <- "Median House Value"
dataVA$y[dataVA$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataVA$y[dataVA$y == "education"] <- "% with less than High-School Education"
dataVA$y[dataVA$y == "population"] <- "Overall Population"
dataVA$y[dataVA$y == "pct_blk"] <- "% African American in County"
dataVA$y[dataVA$y == "hispanic"] <- "% Hispanic in County"
dataVA$y[dataVA$y == "pct_asian"] <- "% Asian in County"
dataVA$y[dataVA$y == "pct_native"] <- "% Native American in County"
dataVA$y[dataVA$y == "pct_white"] <- "% White in County"
dataVA$y[dataVA$y == "q_popdensity"] <- "Population Density"
dataVA$y[dataVA$y == "older_pecent"] <- "% of Population Age 65+"
dataVA$y[dataVA$y == "young_pecent"] <- "% of Population Ages 0-14"
dataVA$y[dataVA$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataVA$y[dataVA$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataVA$y[dataVA$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataVA$y[dataVA$y == "pct_obesity"] <- "% of Adults with Obesity"
dataVA$y[dataVA$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataVA$y[dataVA$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataVA$y[dataVA$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataVA$y[dataVA$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataVA$y[dataVA$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataVA$y[dataVA$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataVA$y[dataVA$y == "infant_deaths"] <- "Number of Infant Deaths"
dataVA$y[dataVA$y == "pct_diabetes"] <- "% of County with Diabetes"
dataVA$y[dataVA$y == "# Food Insecure"] <- "# Food Insecurity"
dataVA$y[dataVA$y == "% Food Insecure"] <- "% Food Insecurity"
dataVA$y[dataVA$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataVA$y[dataVA$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataVA$y[dataVA$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataVA$y[dataVA$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataVA$y[dataVA$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataVA$y[dataVA$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataVA$y[dataVA$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataVA$y[dataVA$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataVA$y[dataVA$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataVA$y[dataVA$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataVA$y[dataVA$y == "Denominator"] <- "Estimated Number of Juveniles"
dataVA$y[dataVA$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataVA$y[dataVA$y == "pct_age65"] <- "% of Adults Age 65+"
dataVA$y[dataVA$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataVA$y[dataVA$y == "Assault.death_rate"] <- "Assault Death Rate"
dataVA$y[dataVA$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataVA$y[dataVA$y == "Despair.death_rate"] <- "Despair Death Rate"
dataVA$y[dataVA$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataVA$y[dataVA$y == "COPD"] <- "% of County with COPD"
dataVA$y[dataVA$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataVA$y[dataVA$y == "LungCancer"] <- "% of County with Lung Cancer"

dataVA$y <- factor(dataVA$y, levels = dataVA$y[order(dataVA$x)])

p<-ggplot(dataVA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("VA_desprt.png")
```

Washington
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "WA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataWA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataWA <- dataWA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataWA$y <- factor(dataWA$y, levels = dataWA$y)

#plot
x <- dataWA$x
x_num<-round(x,digits=2)
dataWA$x_round = x_num

dataWA$y <- as.character(dataWA$y)
dataWA$y[dataWA$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataWA$y[dataWA$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataWA$y[dataWA$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataWA$y[dataWA$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataWA$y[dataWA$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataWA$y[dataWA$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataWA$y[dataWA$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataWA$y[dataWA$y == "% Uninsured"] <- "% of County Uninsured"
dataWA$y[dataWA$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataWA$y[dataWA$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataWA$y[dataWA$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataWA$y[dataWA$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataWA$y[dataWA$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataWA$y[dataWA$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataWA$y[dataWA$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataWA$y[dataWA$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataWA$y[dataWA$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataWA$y[dataWA$y == "Active"] <- "Number of Active COVID-19 Cases"
dataWA$y[dataWA$y == "Lat"] <- "Latitude"
dataWA$y[dataWA$y == "Long_"] <- "Longitude"
dataWA$y[dataWA$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataWA$y[dataWA$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataWA$y[dataWA$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataWA$y[dataWA$y == "poverty"] <- "% Living in Poverty"
dataWA$y[dataWA$y == "popdensity"] <- "Population Density"
dataWA$y[dataWA$y == "medianhousevalue"] <- "Median House Value"
dataWA$y[dataWA$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataWA$y[dataWA$y == "education"] <- "% with less than High-School Education"
dataWA$y[dataWA$y == "population"] <- "Overall Population"
dataWA$y[dataWA$y == "pct_blk"] <- "% African American in County"
dataWA$y[dataWA$y == "hispanic"] <- "% Hispanic in County"
dataWA$y[dataWA$y == "pct_asian"] <- "% Asian in County"
dataWA$y[dataWA$y == "pct_native"] <- "% Native American in County"
dataWA$y[dataWA$y == "pct_white"] <- "% White in County"
dataWA$y[dataWA$y == "q_popdensity"] <- "Population Density"
dataWA$y[dataWA$y == "older_pecent"] <- "% of Population Age 65+"
dataWA$y[dataWA$y == "young_pecent"] <- "% of Population Ages 0-14"
dataWA$y[dataWA$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataWA$y[dataWA$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataWA$y[dataWA$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataWA$y[dataWA$y == "pct_obesity"] <- "% of Adults with Obesity"
dataWA$y[dataWA$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataWA$y[dataWA$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataWA$y[dataWA$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataWA$y[dataWA$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataWA$y[dataWA$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataWA$y[dataWA$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataWA$y[dataWA$y == "infant_deaths"] <- "Number of Infant Deaths"
dataWA$y[dataWA$y == "pct_diabetes"] <- "% of County with Diabetes"
dataWA$y[dataWA$y == "# Food Insecure"] <- "# Food Insecurity"
dataWA$y[dataWA$y == "% Food Insecure"] <- "% Food Insecurity"
dataWA$y[dataWA$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataWA$y[dataWA$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataWA$y[dataWA$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataWA$y[dataWA$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataWA$y[dataWA$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataWA$y[dataWA$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataWA$y[dataWA$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataWA$y[dataWA$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataWA$y[dataWA$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataWA$y[dataWA$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataWA$y[dataWA$y == "Denominator"] <- "Estimated Number of Juveniles"
dataWA$y[dataWA$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataWA$y[dataWA$y == "pct_age65"] <- "% of Adults Age 65+"
dataWA$y[dataWA$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataWA$y[dataWA$y == "Assault.death_rate"] <- "Assault Death Rate"
dataWA$y[dataWA$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataWA$y[dataWA$y == "Despair.death_rate"] <- "Despair Death Rate"
dataWA$y[dataWA$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataWA$y[dataWA$y == "COPD"] <- "% of County with COPD"
dataWA$y[dataWA$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataWA$y[dataWA$y == "LungCancer"] <- "% of County with Lung Cancer"

dataWA$y <- factor(dataWA$y, levels = dataWA$y[order(dataWA$x)])

p<-ggplot(dataWA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.12)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("WA_desprt.png")
```

West Virginia
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "WV"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataWV <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataWV <- dataWV %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataWV$y <- factor(dataWV$y, levels = dataWV$y)

#plot
x <- dataWV$x
x_num<-round(x,digits=2)
dataWV$x_round = x_num

dataWV$y <- as.character(dataWV$y)
dataWV$y[dataWV$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataWV$y[dataWV$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataWV$y[dataWV$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataWV$y[dataWV$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataWV$y[dataWV$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataWV$y[dataWV$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataWV$y[dataWV$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataWV$y[dataWV$y == "% Uninsured"] <- "% of County Uninsured"
dataWV$y[dataWV$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataWV$y[dataWV$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataWV$y[dataWV$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataWV$y[dataWV$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataWV$y[dataWV$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataWV$y[dataWV$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataWV$y[dataWV$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataWV$y[dataWV$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataWV$y[dataWV$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataWV$y[dataWV$y == "Active"] <- "Number of Active COVID-19 Cases"
dataWV$y[dataWV$y == "Lat"] <- "Latitude"
dataWV$y[dataWV$y == "Long_"] <- "Longitude"
dataWV$y[dataWV$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataWV$y[dataWV$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataWV$y[dataWV$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataWV$y[dataWV$y == "poverty"] <- "% Living in Poverty"
dataWV$y[dataWV$y == "popdensity"] <- "Population Density"
dataWV$y[dataWV$y == "medianhousevalue"] <- "Median House Value"
dataWV$y[dataWV$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataWV$y[dataWV$y == "education"] <- "% with less than High-School Education"
dataWV$y[dataWV$y == "population"] <- "Overall Population"
dataWV$y[dataWV$y == "pct_blk"] <- "% African American in County"
dataWV$y[dataWV$y == "hispanic"] <- "% Hispanic in County"
dataWV$y[dataWV$y == "pct_asian"] <- "% Asian in County"
dataWV$y[dataWV$y == "pct_native"] <- "% Native American in County"
dataWV$y[dataWV$y == "pct_white"] <- "% White in County"
dataWV$y[dataWV$y == "q_popdensity"] <- "Population Density"
dataWV$y[dataWV$y == "older_pecent"] <- "% of Population Age 65+"
dataWV$y[dataWV$y == "young_pecent"] <- "% of Population Ages 0-14"
dataWV$y[dataWV$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataWV$y[dataWV$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataWV$y[dataWV$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataWV$y[dataWV$y == "pct_obesity"] <- "% of Adults with Obesity"
dataWV$y[dataWV$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataWV$y[dataWV$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataWV$y[dataWV$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataWV$y[dataWV$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataWV$y[dataWV$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataWV$y[dataWV$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataWV$y[dataWV$y == "infant_deaths"] <- "Number of Infant Deaths"
dataWV$y[dataWV$y == "pct_diabetes"] <- "% of County with Diabetes"
dataWV$y[dataWV$y == "# Food Insecure"] <- "# Food Insecurity"
dataWV$y[dataWV$y == "% Food Insecure"] <- "% Food Insecurity"
dataWV$y[dataWV$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataWV$y[dataWV$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataWV$y[dataWV$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataWV$y[dataWV$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataWV$y[dataWV$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataWV$y[dataWV$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataWV$y[dataWV$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataWV$y[dataWV$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataWV$y[dataWV$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataWV$y[dataWV$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataWV$y[dataWV$y == "Denominator"] <- "Estimated Number of Juveniles"
dataWV$y[dataWV$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataWV$y[dataWV$y == "pct_age65"] <- "% of Adults Age 65+"
dataWV$y[dataWV$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataWV$y[dataWV$y == "Assault.death_rate"] <- "Assault Death Rate"
dataWV$y[dataWV$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataWV$y[dataWV$y == "Despair.death_rate"] <- "Despair Death Rate"
dataWV$y[dataWV$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataWV$y[dataWV$y == "COPD"] <- "% of County with COPD"
dataWV$y[dataWV$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataWV$y[dataWV$y == "LungCancer"] <- "% of County with Lung Cancer"

dataWV$y <- factor(dataWV$y, levels = dataWV$y[order(dataWV$x)])

p<-ggplot(dataWV, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x=-.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("WV_desprt.png")
```


Wisconsin
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "WI"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataWI <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataWI <- dataWI %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataWI$y <- factor(dataWI$y, levels = dataWI$y)

#plot
x <- dataWI$x
x_num<-round(x,digits=2)
dataWI$x_round = x_num

dataWI$y <- as.character(dataWI$y)
dataWI$y[dataWI$y == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
dataWI$y[dataWI$y == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
dataWI$y[dataWI$y == "Cancer.death_rate"] <- "Cancer Death Rate"
dataWI$y[dataWI$y == "% Vaccinated"] <- "% Influenza Vaccinated Medicare FFS"
dataWI$y[dataWI$y == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
dataWI$y[dataWI$y == "Average Grade Performance"] <- "Avg. Reading Grade Performance"
dataWI$y[dataWI$y == "Overcrowding"] <- "% of County with Overcrowded Housing"
dataWI$y[dataWI$y == "% Uninsured"] <- "% of County Uninsured"
dataWI$y[dataWI$y == "% Frequent Mental Distress"] <- "% Frequently Mentally Distressed"
dataWI$y[dataWI$y == "mean_winter_temp"] <- "Mean Winter Temperature"
dataWI$y[dataWI$y == "mean_summer_temp"] <- "Mean Summer Temperature"
dataWI$y[dataWI$y == "mean_winter_rm"] <- "Mean Winter Relative Humidity"
dataWI$y[dataWI$y == "mean_summer_rm"] <- "Mean Summer Relative Humidity"
dataWI$y[dataWI$y == "PediatricAsthma"] <- "% of County with Pediatric Asthma"
dataWI$y[dataWI$y == "% less than 18 years of age"] <- "% less than 18 Years of Age"
dataWI$y[dataWI$y == "Case.Fatality_Ratio"] <- "COVID-19 Case Fatality Ratio"
dataWI$y[dataWI$y == "Incidence_Rate"] <- "COVID-19 Incidence Rate"
dataWI$y[dataWI$y == "Active"] <- "Number of Active COVID-19 Cases"
dataWI$y[dataWI$y == "Lat"] <- "Latitude"
dataWI$y[dataWI$y == "Long_"] <- "Longitude"
dataWI$y[dataWI$y == "Confirmed"] <- "Number of Confirmed COVID-19 Cases"
dataWI$y[dataWI$y == "Deaths"] <- "Number of COVID-19 Deaths"
dataWI$y[dataWI$y == "Recovered"] <- "Number of People Recovered from COVID-19"
dataWI$y[dataWI$y == "poverty"] <- "% Living in Poverty"
dataWI$y[dataWI$y == "popdensity"] <- "Population Density"
dataWI$y[dataWI$y == "medianhousevalue"] <- "Median House Value"
dataWI$y[dataWI$y == "pcc_owner_occ"] <- "% Owner-Occupied Housing"
dataWI$y[dataWI$y == "education"] <- "% with less than High-School Education"
dataWI$y[dataWI$y == "population"] <- "Overall Population"
dataWI$y[dataWI$y == "pct_blk"] <- "% African American in County"
dataWI$y[dataWI$y == "hispanic"] <- "% Hispanic in County"
dataWI$y[dataWI$y == "pct_asian"] <- "% Asian in County"
dataWI$y[dataWI$y == "pct_native"] <- "% Native American in County"
dataWI$y[dataWI$y == "pct_white"] <- "% White in County"
dataWI$y[dataWI$y == "q_popdensity"] <- "Population Density"
dataWI$y[dataWI$y == "older_pecent"] <- "% of Population Age 65+"
dataWI$y[dataWI$y == "young_pecent"] <- "% of Population Ages 0-14"
dataWI$y[dataWI$y == "prime_pecent"] <- "% of Population Ages 15-44"
dataWI$y[dataWI$y == "mid_pecent"] <- "% of Population Ages 45-64"
dataWI$y[dataWI$y == "Average Number of Mentally Unhealthy Days"] <- "Avg. Number of Mentally Unhealthy Days"
dataWI$y[dataWI$y == "pct_obesity"] <- "% of Adults with Obesity"
dataWI$y[dataWI$y == "80th Percentile Income"] <- "80th Percentile for Median Household Income"
dataWI$y[dataWI$y == "20th Percentile Income"] <- "20th Percentile for Median Household Income"
dataWI$y[dataWI$y == "mean_pm25"] <- "Average Air Quality (PM2.5)"
dataWI$y[dataWI$y == "pre_covid_deaths"] <- "Deaths before COVID-19 Infection"
dataWI$y[dataWI$y == "pre_covid_death_rate"] <- "Death Rate before COVID-19 Infection"
dataWI$y[dataWI$y == "child_deaths"] <- "Number of Children Deaths Under Age of 18"
dataWI$y[dataWI$y == "infant_deaths"] <- "Number of Infant Deaths"
dataWI$y[dataWI$y == "pct_diabetes"] <- "% of County with Diabetes"
dataWI$y[dataWI$y == "# Food Insecure"] <- "# Food Insecurity"
dataWI$y[dataWI$y == "% Food Insecure"] <- "% Food Insecurity"
dataWI$y[dataWI$y == "# Limited Access"] <- "# Limited Access to Healthy Foods"
dataWI$y[dataWI$y == "# Uninsured_1"] <- "# of Adults Under 65 with No Health Insurance"
dataWI$y[dataWI$y == "% Uninsured_1"] <- "% of Adults Under 65 with No Health Insurance"
dataWI$y[dataWI$y == "# Uninsured_2"] <- "# of Children with No Health Insurance"
dataWI$y[dataWI$y == "% Uninsured_2"] <- "% of Children with No Health Insurance"
dataWI$y[dataWI$y == "Average Grade Performance_1"] <- "Avg. Math Grade Performance"
dataWI$y[dataWI$y == "Segregation index"] <- "Segregation Index Between Black and White"
dataWI$y[dataWI$y == "Segregation Index"] <- "Segregation Index Between Non-White and White"
dataWI$y[dataWI$y == "suicide_deaths"] <- "# of Suicide Deaths"
dataWI$y[dataWI$y == "Crude Rate"] <- "Not Adjusted Suicide Rate"
dataWI$y[dataWI$y == "Denominator"] <- "Estimated Number of Juveniles"
dataWI$y[dataWI$y == "Average Traffic Volume per Meter of Major Roadways"] <- "Avg. Traffic Volume per Meter of Major Roadways"
dataWI$y[dataWI$y == "pct_age65"] <- "% of Adults Age 65+"
dataWI$y[dataWI$y == "All.Cause.death_rate"] <- "All Cause Death Rate"
dataWI$y[dataWI$y == "Assault.death_rate"] <- "Assault Death Rate"
dataWI$y[dataWI$y == "Cardiovascular.death_rate"] <- "Cardiovascular Disease Death Rate"
dataWI$y[dataWI$y == "Despair.death_rate"] <- "Despair Death Rate"
dataWI$y[dataWI$y == "AdultAsthma"] <- "% of County with Adult Asthma"
dataWI$y[dataWI$y == "COPD"] <- "% of County with COPD"
dataWI$y[dataWI$y == "AdultChronicLungDisease"] <- "% of County with Adult Chronic Lung Disease"
dataWI$y[dataWI$y == "LungCancer"] <- "% of County with Lung Cancer"

dataWI$y <- factor(dataWI$y, levels = dataWI$y[order(dataWI$x)])

p<-ggplot(dataWI, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="#ebebeb", size=3.5, nudge_x = -.1)+
  geom_segment( aes(x=1, xend=1, y=0, yend = length(vals)), size = 1.0)
}
p
ggsave("WI_desprt.png")
```

Wyoming (not enough data)
```{r}
ggplot() + theme_void() +
  geom_text(aes(x = 0, y = 0, label="There are no significant social determinants."))
ggsave("WY_desprt.png")
```
